import{d as dt,l as v,a as vt,i as rt,g as yt,b as kt,f as bt,c as wt,p as Ct}from"./postCliente.DVX4mV6T.js";(function(u,h,p){function l(i,t){for(;(i=i.parentElement)&&!i.classList.contains(t););return i}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(i,t){this._map=i,this._container=i._container,this._overlayPane=i._panes.overlayPane,this._popupPane=i._panes.popupPane,t&&t.shapeOptions&&(t.shapeOptions=L.Util.extend({},this.options.shapeOptions,t.shapeOptions)),L.setOptions(this,t);var e=L.version.split(".");parseInt(e[0],10)===1&&parseInt(e[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var i=this._map;i&&(L.DomUtil.disableTextSelection(),i.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(i){L.setOptions(this,i)},_fireCreatedEvent:function(i){this._map.fire(L.Draw.Event.CREATED,{layer:i,layerType:this.type})},_cancelDrawing:function(i){i.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(i,t){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,t&&t.drawError&&(t.drawError=L.Util.extend({},this.options.drawError,t.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,i,t)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var i=this._markers.pop(),t=this._poly,e=t.getLatLngs(),o=e.splice(-1,1)[0];this._poly.setLatLngs(e),this._markerGroup.removeLayer(i),t.getLatLngs().length<2&&this._map.removeLayer(t),this._vertexChanged(o,!1)}},addVertex:function(i){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(i))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(i)),this._poly.addLatLng(i),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(i,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var i=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),t=this._poly.newLatLngIntersects(i[i.length-1]);if(!this.options.allowIntersection&&t||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(i){var t=this._map.mouseEventToLayerPoint(i.originalEvent),e=this._map.layerPointToLatLng(t);this._currentLatLng=e,this._updateTooltip(e),this._updateGuide(t),this._mouseMarker.setLatLng(e),L.DomEvent.preventDefault(i.originalEvent)},_vertexChanged:function(i,t){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(i,t),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(i){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(i),this._clickHandled=!0,this._disableNewMarkers();var t=i.originalEvent,e=t.clientX,o=t.clientY;this._startPoint.call(this,e,o)}},_startPoint:function(i,t){this._mouseDownOrigin=L.point(i,t)},_onMouseUp:function(i){var t=i.originalEvent,e=t.clientX,o=t.clientY;this._endPoint.call(this,e,o,i),this._clickHandled=null},_endPoint:function(i,t,e){if(this._mouseDownOrigin){var o=L.point(i,t).distanceTo(this._mouseDownOrigin),n=this._calculateFinishDistance(e.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(e.latlng),this._finishShape()):n<10&&L.Browser.touch?this._finishShape():Math.abs(o)<9*(u.devicePixelRatio||1)&&this.addVertex(e.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(i){var t,e,o=i.originalEvent;!o.touches||!o.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(t=o.touches[0].clientX,e=o.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,t,e),this._endPoint.call(this,t,e,i),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(i){var t;if(this._markers.length>0){var e;if(this.type===L.Draw.Polyline.TYPE)e=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;e=this._markers[0]}var o=this._map.latLngToContainerPoint(e.getLatLng()),n=new L.Marker(i,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),r=this._map.latLngToContainerPoint(n.getLatLng());t=o.distanceTo(r)}else t=1/0;return t},_updateFinishHandler:function(){var i=this._markers.length;i>1&&this._markers[i-1].on("click",this._finishShape,this),i>2&&this._markers[i-2].off("click",this._finishShape,this)},_createMarker:function(i){var t=new L.Marker(i,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(t),t},_updateGuide:function(i){var t=this._markers?this._markers.length:0;t>0&&(i=i||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[t-1].getLatLng()),i))},_updateTooltip:function(i){var t=this._getTooltipText();i&&this._tooltip.updatePosition(i),this._errorShown||this._tooltip.updateContent(t)},_drawGuide:function(i,t){var e,o,n,r=Math.floor(Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))),s=this.options.guidelineDistance,a=this.options.maxGuideLineLength,d=r>a?r-a:s;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));d<r;d+=this.options.guidelineDistance)e=d/r,o={x:Math.floor(i.x*(1-e)+e*t.x),y:Math.floor(i.y*(1-e)+e*t.y)},n=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),n.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(n,o)},_updateGuideColor:function(i){if(this._guidesContainer)for(var t=0,e=this._guidesContainer.childNodes.length;t<e;t++)this._guidesContainer.childNodes[t].style.backgroundColor=i},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var i,t,e=this.options.showLength;return this._markers.length===0?i={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(t=e?this._getMeasurementString():"",i=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:t}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:t}),i},_updateRunningMeasure:function(i,t){var e,o,n=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(e=n-(t?2:1),o=L.GeometryUtil.isVersion07x()?i.distanceTo(this._markers[e].getLatLng())*(this.options.factor||1):this._map.distance(i,this._markers[e].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=o*(t?1:-1))},_getMeasurementString:function(){var i,t=this._currentLatLng,e=this._markers[this._markers.length-1].getLatLng();return i=L.GeometryUtil.isVersion07x()?e&&t&&t.distanceTo?this._measurementRunningTotal+t.distanceTo(e)*(this.options.factor||1):this._measurementRunningTotal||0:e&&t?this._measurementRunningTotal+this._map.distance(t,e)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(i,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var i=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,i)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(i,t){L.Draw.Polyline.prototype.initialize.call(this,i,t),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var i=this._markers.length;i===1&&this._markers[0].on("click",this._finishShape,this),i>2&&(this._markers[i-1].on("dblclick",this._finishShape,this),i>3&&this._markers[i-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var i,t;return this._markers.length===0?i=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(i=L.drawLocal.draw.handlers.polygon.tooltip.cont,t=this._getMeasurementString()):(i=L.drawLocal.draw.handlers.polygon.tooltip.end,t=this._getMeasurementString()),{text:i,subtext:t}},_getMeasurementString:function(){var i=this._area,t="";return i||this.options.showLength?(this.options.showLength&&(t=L.Draw.Polyline.prototype._getMeasurementString.call(this)),i&&(t+="<br>"+L.GeometryUtil.readableArea(i,this.options.metric,this.options.precision)),t):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(i,t){var e;!this.options.allowIntersection&&this.options.showArea&&(e=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(e)),L.Draw.Polyline.prototype._vertexChanged.call(this,i,t)},_cleanUpShape:function(){var i=this._markers.length;i>0&&(this._markers[0].off("click",this._finishShape,this),i>2&&this._markers[i-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(i,t){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,i,t)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),h.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(h,"mouseup",this._onMouseUp,this),L.DomEvent.off(h,"touchend",this._onMouseUp,this),h.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(i){this._isDrawing=!0,this._startLatLng=i.latlng,L.DomEvent.on(h,"mouseup",this._onMouseUp,this).on(h,"touchend",this._onMouseUp,this).preventDefault(i.originalEvent)},_onMouseMove:function(i){var t=i.latlng;this._tooltip.updatePosition(t),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(t))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(i,t){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,i,t)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(i){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!l(i.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(i){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,i)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,i),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var i=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,i)},_getTooltipText:function(){var i,t,e,o=L.Draw.SimpleShape.prototype._getTooltipText.call(this),n=this._shape,r=this.options.showArea;return n&&(i=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),t=L.GeometryUtil.geodesicArea(i),e=r?L.GeometryUtil.readableArea(t,this.options.metric):""),{text:o.text,subtext:e}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(i,t){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,i,t)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(i){var t=i.latlng;this._tooltip.updatePosition(t),this._mouseMarker.setLatLng(t),this._marker?(t=this._mouseMarker.getLatLng(),this._marker.setLatLng(t)):(this._marker=this._createMarker(t),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(i){return new L.Marker(i,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(i){this._onMouseMove(i),this._onClick()},_fireCreatedEvent:function(){var i=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,i)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(i,t){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,i,t)},_fireCreatedEvent:function(){var i=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,i)},_createMarker:function(i){return new L.CircleMarker(i,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(i,t){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,i,t)},_drawShape:function(i){if(L.GeometryUtil.isVersion07x())var t=this._startLatLng.distanceTo(i);else var t=this._map.distance(this._startLatLng,i);this._shape?this._shape.setRadius(t):(this._shape=new L.Circle(this._startLatLng,t,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var i=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,i)},_onMouseMove:function(i){var t,e=i.latlng,o=this.options.showRadius,n=this.options.metric;if(this._tooltip.updatePosition(e),this._isDrawing){this._drawShape(e),t=this._shape.getRadius().toFixed(1);var r="";o&&(r=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(t,n,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:r})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(i,t){this._marker=i,L.setOptions(this,t)},addHooks:function(){var i=this._marker;i.dragging.enable(),i.on("dragend",this._onDragEnd,i),this._toggleMarkerHighlight()},removeHooks:function(){var i=this._marker;i.dragging.disable(),i.off("dragend",this._onDragEnd,i),this._toggleMarkerHighlight()},_onDragEnd:function(i){var t=i.target;t.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:t})},_toggleMarkerHighlight:function(){var i=this._marker._icon;i&&(i.style.display="none",L.DomUtil.hasClass(i,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(i,"leaflet-edit-marker-selected"),this._offsetMarker(i,-4)):(L.DomUtil.addClass(i,"leaflet-edit-marker-selected"),this._offsetMarker(i,4)),i.style.display="")},_offsetMarker:function(i,t){var e=parseInt(i.style.marginTop,10)-t,o=parseInt(i.style.marginLeft,10)-t;i.style.marginTop=e+"px",i.style.marginLeft=o+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(i){this.latlngs=[i._latlngs],i._holes&&(this.latlngs=this.latlngs.concat(i._holes)),this._poly=i,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(i){for(var t=0;t<this._verticesHandlers.length;t++)i(this._verticesHandlers[t])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(i){i.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(i){i.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(i){i.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var i=0;i<this.latlngs.length;i++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[i],this._poly.options.poly))},_updateLatLngs:function(i){this.latlngs=[i.layer._latlngs],i.layer._holes&&(this.latlngs=this.latlngs.concat(i.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(i,t,e){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=i,e&&e.drawError&&(e.drawError=L.Util.extend({},this.options.drawError,e.drawError)),this._latlngs=t,L.setOptions(this,e)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var i=this._poly,t=i._path;i instanceof L.Polygon||(i.options.fill=!1,i.options.editing&&(i.options.editing.fill=!1)),t&&i.options.editing&&i.options.editing.className&&(i.options.original.className&&i.options.original.className.split(" ").forEach(function(e){L.DomUtil.removeClass(t,e)}),i.options.editing.className.split(" ").forEach(function(e){L.DomUtil.addClass(t,e)})),i.setStyle(i.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var i=this._poly,t=i._path;t&&i.options.editing&&i.options.editing.className&&(i.options.editing.className.split(" ").forEach(function(e){L.DomUtil.removeClass(t,e)}),i.options.original.className&&i.options.original.className.split(" ").forEach(function(e){L.DomUtil.addClass(t,e)})),i.setStyle(i.options.original),i._map&&(i._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var i,t,e,o,n=this._defaultShape();for(i=0,e=n.length;i<e;i++)o=this._createMarker(n[i],i),o.on("click",this._onMarkerClick,this),o.on("contextmenu",this._onContextMenu,this),this._markers.push(o);var r,s;for(i=0,t=e-1;i<e;t=i++)(i!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(r=this._markers[t],s=this._markers[i],this._createMiddleMarker(r,s),this._updatePrevNext(r,s))},_createMarker:function(i,t){var e=new L.Marker.Touch(i,{draggable:!0,icon:this.options.icon});return e._origLatLng=i,e._index=t,e.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(e),e},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var i=this._defaultShape(),t=[].splice.apply(i,arguments);return this._poly._convertLatLngs(i,!0),this._poly.redraw(),t},_removeMarker:function(i){var t=i._index;this._markerGroup.removeLayer(i),this._markers.splice(t,1),this._spliceLatLngs(t,1),this._updateIndexes(t,-1),i.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(i){var t=i.target,e=this._poly,o=L.LatLngUtil.cloneLatLng(t._origLatLng);if(L.extend(t._origLatLng,t._latlng),e.options.poly){var n=e._map._editTooltip;if(!e.options.poly.allowIntersection&&e.intersects()){L.extend(t._origLatLng,o),t.setLatLng(o);var r=e.options.color;e.setStyle({color:this.options.drawError.color}),n&&n.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){e.setStyle({color:r}),n&&n.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}t._middleLeft&&t._middleLeft.setLatLng(this._getMiddleLatLng(t._prev,t)),t._middleRight&&t._middleRight.setLatLng(this._getMiddleLatLng(t,t._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var s=this._poly.getLatLngs();this._poly._convertLatLngs(s,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(i){var t=L.Polygon&&this._poly instanceof L.Polygon?4:3,e=i.target;this._defaultShape().length<t||(this._removeMarker(e),this._updatePrevNext(e._prev,e._next),e._middleLeft&&this._markerGroup.removeLayer(e._middleLeft),e._middleRight&&this._markerGroup.removeLayer(e._middleRight),e._prev&&e._next?this._createMiddleMarker(e._prev,e._next):e._prev?e._next||(e._prev._middleRight=null):e._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(i){var t=i.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:t,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(i){var t=this._map.mouseEventToLayerPoint(i.originalEvent.touches[0]),e=this._map.layerPointToLatLng(t),o=i.target;L.extend(o._origLatLng,e),o._middleLeft&&o._middleLeft.setLatLng(this._getMiddleLatLng(o._prev,o)),o._middleRight&&o._middleRight.setLatLng(this._getMiddleLatLng(o,o._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(i,t){this._markerGroup.eachLayer(function(e){e._index>i&&(e._index+=t)})},_createMiddleMarker:function(i,t){var e,o,n,r=this._getMiddleLatLng(i,t),s=this._createMarker(r);s.setOpacity(.6),i._middleRight=t._middleLeft=s,o=function(){s.off("touchmove",o,this);var a=t._index;s._index=a,s.off("click",e,this).on("click",this._onMarkerClick,this),r.lat=s.getLatLng().lat,r.lng=s.getLatLng().lng,this._spliceLatLngs(a,0,r),this._markers.splice(a,0,s),s.setOpacity(1),this._updateIndexes(a,1),t._index++,this._updatePrevNext(i,s),this._updatePrevNext(s,t),this._poly.fire("editstart")},n=function(){s.off("dragstart",o,this),s.off("dragend",n,this),s.off("touchmove",o,this),this._createMiddleMarker(i,s),this._createMiddleMarker(s,t)},e=function(){o.call(this),n.call(this),this._fireEdit()},s.on("click",e,this).on("dragstart",o,this).on("dragend",n,this).on("touchmove",o,this),this._markerGroup.addLayer(s)},_updatePrevNext:function(i,t){i&&(i._next=t),t&&(t._prev=i)},_getMiddleLatLng:function(i,t){var e=this._poly._map,o=e.project(i.getLatLng()),n=e.project(t.getLatLng());return e.unproject(o._add(n)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(i,t){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=i,L.Util.setOptions(this,t)},addHooks:function(){var i=this._shape;this._shape._map&&(this._map=this._shape._map,i.setStyle(i.options.editing),i._map&&(this._map=i._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var i=this._shape;if(i.setStyle(i.options.original),i._map){this._unbindMarker(this._moveMarker);for(var t=0,e=this._resizeMarkers.length;t<e;t++)this._unbindMarker(this._resizeMarkers[t]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(i,t){var e=new L.Marker.Touch(i,{draggable:!0,icon:t,zIndexOffset:10});return this._bindMarker(e),this._markerGroup.addLayer(e),e},_bindMarker:function(i){i.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(i){i.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(i){i.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(i){var t=i.target,e=t.getLatLng();t===this._moveMarker?this._move(e):this._resize(e),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(i){i.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(i){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,i),typeof this._getCorners=="function"){var t=this._getCorners(),e=i.target,o=e._cornerIndex;e.setOpacity(0),this._oppositeCorner=t[(o+2)%4],this._toggleCornerMarkers(0,o)}this._shape.fire("editstart")},_onTouchMove:function(i){var t=this._map.mouseEventToLayerPoint(i.originalEvent.touches[0]),e=this._map.layerPointToLatLng(t);return i.target===this._moveMarker?this._move(e):this._resize(e),this._shape.redraw(),!1},_onTouchEnd:function(i){i.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var i=this._shape.getBounds(),t=i.getCenter();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){var i=this._getCorners();this._resizeMarkers=[];for(var t=0,e=i.length;t<e;t++)this._resizeMarkers.push(this._createMarker(i[t],this.options.resizeIcon)),this._resizeMarkers[t]._cornerIndex=t},_onMarkerDragStart:function(i){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,i);var t=this._getCorners(),e=i.target,o=e._cornerIndex;this._oppositeCorner=t[(o+2)%4],this._toggleCornerMarkers(0,o)},_onMarkerDragEnd:function(i){var t,e,o=i.target;o===this._moveMarker&&(t=this._shape.getBounds(),e=t.getCenter(),o.setLatLng(e)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,i)},_move:function(i){for(var t,e=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),o=this._shape.getBounds(),n=o.getCenter(),r=[],s=0,a=e.length;s<a;s++)t=[e[s].lat-n.lat,e[s].lng-n.lng],r.push([i.lat+t[0],i.lng+t[1]]);this._shape.setLatLngs(r),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(i){var t;this._shape.setBounds(L.latLngBounds(i,this._oppositeCorner)),t=this._shape.getBounds(),this._moveMarker.setLatLng(t.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var i=this._shape.getBounds();return[i.getNorthWest(),i.getNorthEast(),i.getSouthEast(),i.getSouthWest()]},_toggleCornerMarkers:function(i){for(var t=0,e=this._resizeMarkers.length;t<e;t++)this._resizeMarkers[t].setOpacity(i)},_repositionCornerMarkers:function(){for(var i=this._getCorners(),t=0,e=this._resizeMarkers.length;t<e;t++)this._resizeMarkers[t].setLatLng(i[t])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var i=this._shape.getLatLng();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(i){if(this._resizeMarkers.length){var t=this._getResizeMarkerPoint(i);this._resizeMarkers[0].setLatLng(t)}this._shape.setLatLng(i),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var i=this._shape.getLatLng(),t=this._getResizeMarkerPoint(i);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(t,this.options.resizeIcon))},_getResizeMarkerPoint:function(i){var t=this._shape._radius*Math.cos(Math.PI/4),e=this._map.project(i);return this._map.unproject([e.x+t,e.y-t])},_resize:function(i){var t=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=t.distanceTo(i):radius=this._map.distance(t,i),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(i){this._map=i,this._container=i._container,this._pane=i._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(i,t){var e={};if(i.touches!==void 0){if(!i.touches.length)return;e=i.touches[0]}else if(i.pointerType!=="touch"||(e=i,!this._filterClick(i)))return;var o=this._map.mouseEventToContainerPoint(e),n=this._map.mouseEventToLayerPoint(e),r=this._map.layerPointToLatLng(n);this._map.fire(t,{latlng:r,layerPoint:n,containerPoint:o,pageX:e.pageX,pageY:e.pageY,originalEvent:i})},_filterClick:function(i){var t=i.timeStamp||i.originalEvent.timeStamp,e=L.DomEvent._lastClick&&t-L.DomEvent._lastClick;return e&&e>100&&e<500||i.target._simulatedClick&&!i._simulated?(L.DomEvent.stop(i),!1):(L.DomEvent._lastClick=t,!0)},_onTouchStart:function(i){this._map._loaded&&this._touchEvent(i,"touchstart")},_onTouchEnd:function(i){this._map._loaded&&this._touchEvent(i,"touchend")},_onTouchCancel:function(i){if(this._map._loaded){var t="touchcancel";this._detectIE()&&(t="pointercancel"),this._touchEvent(i,t)}},_onTouchLeave:function(i){this._map._loaded&&this._touchEvent(i,"touchleave")},_onTouchMove:function(i){this._map._loaded&&this._touchEvent(i,"touchmove")},_detectIE:function(){var i=u.navigator.userAgent,t=i.indexOf("MSIE ");if(t>0)return parseInt(i.substring(t+5,i.indexOf(".",t)),10);if(i.indexOf("Trident/")>0){var e=i.indexOf("rv:");return parseInt(i.substring(e+3,i.indexOf(".",e)),10)}var o=i.indexOf("Edge/");return o>0&&parseInt(i.substring(o+5,i.indexOf(".",o)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var i=this._icon,t=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?t.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):t.concat(["touchcancel"]),L.DomUtil.addClass(i,"leaflet-clickable"),L.DomEvent.on(i,"click",this._onMouseClick,this),L.DomEvent.on(i,"keypress",this._onKeyPress,this);for(var e=0;e<t.length;e++)L.DomEvent.on(i,t[e],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var i=u.navigator.userAgent,t=i.indexOf("MSIE ");if(t>0)return parseInt(i.substring(t+5,i.indexOf(".",t)),10);if(i.indexOf("Trident/")>0){var e=i.indexOf("rv:");return parseInt(i.substring(e+3,i.indexOf(".",e)),10)}var o=i.indexOf("Edge/");return o>0&&parseInt(i.substring(o+5,i.indexOf(".",o)),10)}}),L.LatLngUtil={cloneLatLngs:function(i){for(var t=[],e=0,o=i.length;e<o;e++)Array.isArray(i[e])?t.push(L.LatLngUtil.cloneLatLngs(i[e])):t.push(this.cloneLatLng(i[e]));return t},cloneLatLng:function(i){return L.latLng(i.lat,i.lng)}},function(){var i={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(t){var e,o,n=t.length,r=0,s=Math.PI/180;if(n>2){for(var a=0;a<n;a++)e=t[a],o=t[(a+1)%n],r+=(o.lng-e.lng)*s*(2+Math.sin(e.lat*s)+Math.sin(o.lat*s));r=6378137*r*6378137/2}return Math.abs(r)},formattedNumber:function(t,e){var o=parseFloat(t).toFixed(e),n=L.drawLocal.format&&L.drawLocal.format.numeric,r=n&&n.delimiters,s=r&&r.thousands,a=r&&r.decimal;if(s||a){var d=o.split(".");o=s?d[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+s):d[0],a=a||".",d.length>1&&(o=o+a+d[1])}return o},readableArea:function(t,e,s){var n,r,s=L.Util.extend({},i,s);return e?(r=["ha","m"],type=typeof e,type==="string"?r=[e]:type!=="boolean"&&(r=e),n=t>=1e6&&r.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*t,s.km)+" km²":t>=1e4&&r.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*t,s.ha)+" ha":L.GeometryUtil.formattedNumber(t,s.m)+" m²"):(t/=.836127,n=t>=3097600?L.GeometryUtil.formattedNumber(t/3097600,s.mi)+" mi²":t>=4840?L.GeometryUtil.formattedNumber(t/4840,s.ac)+" acres":L.GeometryUtil.formattedNumber(t,s.yd)+" yd²"),n},readableDistance:function(t,e,o,n,a){var s,a=L.Util.extend({},i,a);switch(e?typeof e=="string"?e:"metric":o?"feet":n?"nauticalMile":"yards"){case"metric":s=t>1e3?L.GeometryUtil.formattedNumber(t/1e3,a.km)+" km":L.GeometryUtil.formattedNumber(t,a.m)+" m";break;case"feet":t*=3.28083,s=L.GeometryUtil.formattedNumber(t,a.ft)+" ft";break;case"nauticalMile":t*=.53996,s=L.GeometryUtil.formattedNumber(t/1e3,a.nm)+" nm";break;case"yards":default:t*=1.09361,s=t>1760?L.GeometryUtil.formattedNumber(t/1760,a.mi)+" miles":L.GeometryUtil.formattedNumber(t,a.yd)+" yd"}return s},isVersion07x:function(){var t=L.version.split(".");return parseInt(t[0],10)===0&&parseInt(t[1],10)===7}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(i,t,e,o){return this._checkCounterclockwise(i,e,o)!==this._checkCounterclockwise(t,e,o)&&this._checkCounterclockwise(i,t,e)!==this._checkCounterclockwise(i,t,o)},_checkCounterclockwise:function(i,t,e){return(e.y-i.y)*(t.x-i.x)>(t.y-i.y)*(e.x-i.x)}}),L.Polyline.include({intersects:function(){var i,t,e,o=this._getProjectedPoints(),n=o?o.length:0;if(this._tooFewPointsForIntersection())return!1;for(i=n-1;i>=3;i--)if(t=o[i-1],e=o[i],this._lineSegmentsIntersectsRange(t,e,i-2))return!0;return!1},newLatLngIntersects:function(i,t){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(i),t)},newPointIntersects:function(i,t){var e=this._getProjectedPoints(),o=e?e.length:0,n=e?e[o-1]:null,r=o-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(n,i,r,t?1:0)},_tooFewPointsForIntersection:function(i){var t=this._getProjectedPoints(),e=t?t.length:0;return e+=i||0,!t||e<=3},_lineSegmentsIntersectsRange:function(i,t,e,o){var n,r,s=this._getProjectedPoints();o=o||0;for(var a=e;a>o;a--)if(n=s[a-1],r=s[a],L.LineUtil.segmentsIntersect(i,t,n,r))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var i=[],t=this._defaultShape(),e=0;e<t.length;e++)i.push(this._map.latLngToLayerPoint(t[e]));return i}}),L.Polygon.include({intersects:function(){var i,t,e,o,n=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(i=n.length,t=n[0],e=n[i-1],o=i-2,this._lineSegmentsIntersectsRange(e,t,o,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(i){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,i);var t;this._toolbars={},L.DrawToolbar&&this.options.draw&&(t=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=t,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(t=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=t,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(i){var t,e=L.DomUtil.create("div","leaflet-draw"),o=!1;for(var n in this._toolbars)this._toolbars.hasOwnProperty(n)&&(t=this._toolbars[n].addToolbar(i))&&(o||(L.DomUtil.hasClass(t,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(t.childNodes[0],"leaflet-draw-toolbar-top"),o=!0),e.appendChild(t));return e},onRemove:function(){for(var i in this._toolbars)this._toolbars.hasOwnProperty(i)&&this._toolbars[i].removeToolbar()},setDrawingOptions:function(i){for(var t in this._toolbars)this._toolbars[t]instanceof L.DrawToolbar&&this._toolbars[t].setOptions(i)},_toolbarEnabled:function(i){var t=i.target;for(var e in this._toolbars)this._toolbars[e]!==t&&this._toolbars[e].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(i){L.setOptions(this,i),this._modes={},this._actionButtons=[],this._activeMode=null;var t=L.version.split(".");parseInt(t[0],10)===1&&parseInt(t[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(i){var t,e=L.DomUtil.create("div","leaflet-draw-section"),o=0,n=this._toolbarClass||"",r=this.getModeHandlers(i);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=i,t=0;t<r.length;t++)r[t].enabled&&this._initModeHandler(r[t].handler,this._toolbarContainer,o++,n,r[t].title);if(o)return this._lastButtonIndex=--o,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),e.appendChild(this._toolbarContainer),e.appendChild(this._actionsContainer),e},removeToolbar:function(){for(var i in this._modes)this._modes.hasOwnProperty(i)&&(this._disposeButton(this._modes[i].button,this._modes[i].handler.enable,this._modes[i].handler),this._modes[i].handler.disable(),this._modes[i].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var t=0,e=this._actionButtons.length;t<e;t++)this._disposeButton(this._actionButtons[t].button,this._actionButtons[t].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(i,t,e,o,n){var r=i.type;this._modes[r]={},this._modes[r].handler=i,this._modes[r].button=this._createButton({type:r,title:n,className:o+"-"+r,container:t,callback:this._modes[r].handler.enable,context:this._modes[r].handler}),this._modes[r].buttonIndex=e,this._modes[r].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!u.MSStream},_createButton:function(i){var t=L.DomUtil.create("a",i.className||"",i.container),e=L.DomUtil.create("span","sr-only",i.container);t.href="#",t.appendChild(e),i.title&&(t.title=i.title,e.innerHTML=i.title),i.text&&(t.innerHTML=i.text,e.innerHTML=i.text);var o=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(t,"click",L.DomEvent.stopPropagation).on(t,"mousedown",L.DomEvent.stopPropagation).on(t,"dblclick",L.DomEvent.stopPropagation).on(t,"touchstart",L.DomEvent.stopPropagation).on(t,"click",L.DomEvent.preventDefault).on(t,o,i.callback,i.context),t},_disposeButton:function(i,t){var e=this._detectIOS()?"touchstart":"click";L.DomEvent.off(i,"click",L.DomEvent.stopPropagation).off(i,"mousedown",L.DomEvent.stopPropagation).off(i,"dblclick",L.DomEvent.stopPropagation).off(i,"touchstart",L.DomEvent.stopPropagation).off(i,"click",L.DomEvent.preventDefault).off(i,e,t)},_handlerActivated:function(i){this.disable(),this._activeMode=this._modes[i.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(i){var t,e,o,n,r=this._actionsContainer,s=this.getActions(i),a=s.length;for(e=0,o=this._actionButtons.length;e<o;e++)this._disposeButton(this._actionButtons[e].button,this._actionButtons[e].callback);for(this._actionButtons=[];r.firstChild;)r.removeChild(r.firstChild);for(var d=0;d<a;d++)"enabled"in s[d]&&!s[d].enabled||(t=L.DomUtil.create("li","",r),n=this._createButton({title:s[d].title,text:s[d].text,container:t,callback:s[d].callback,context:s[d].context}),this._actionButtons.push({button:n,callback:s[d].callback}))},_showActionsToolbar:function(){var i=this._activeMode.buttonIndex,t=this._lastButtonIndex,e=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=e+"px",i===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),i===t&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(i){this._map=i,this._popupPane=i._panes.popupPane,this._visible=!1,this._container=i.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(i){return this._container?(i.subtext=i.subtext||"",i.subtext.length!==0||this._singleLineLabel?i.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(i.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+i.subtext+"</span><br />":"")+"<span>"+i.text+"</span>",i.text||i.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(i){var t=this._map.latLngToLayerPoint(i),e=this._container;return this._container&&(this._visible&&(e.style.visibility="inherit"),L.DomUtil.setPosition(e,t)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(i){for(var t in this.options)this.options.hasOwnProperty(t)&&i[t]&&(i[t]=L.extend({},this.options[t],i[t]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,i)},getModeHandlers:function(i){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(i,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(i,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(i,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(i,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(i,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(i,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(i){return[{enabled:i.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:i.completeShape,context:i},{enabled:i.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:i.deleteLastVertex,context:i},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(i){L.setOptions(this,i);for(var t in this._modes)this._modes.hasOwnProperty(t)&&i.hasOwnProperty(t)&&this._modes[t].handler.setOptions(i[t])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(i){i.edit&&(i.edit.selectedPathOptions===void 0&&(i.edit.selectedPathOptions=this.options.edit.selectedPathOptions),i.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,i.edit.selectedPathOptions)),i.remove&&(i.remove=L.extend({},this.options.remove,i.remove)),i.poly&&(i.poly=L.extend({},this.options.poly,i.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,i),this._selectedFeatureCount=0},getModeHandlers:function(i){var t=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(i,{featureGroup:t,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(i,{featureGroup:t}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(i){var t=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return i.removeAllLayers&&t.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),t},addToolbar:function(i){var t=L.Toolbar.prototype.addToolbar.call(this,i);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),t},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var i,t=this.options.featureGroup,e=t.getLayers().length!==0;this.options.edit&&(i=this._modes[L.EditToolbar.Edit.TYPE].button,e?L.DomUtil.removeClass(i,"leaflet-disabled"):L.DomUtil.addClass(i,"leaflet-disabled"),i.setAttribute("title",e?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(i=this._modes[L.EditToolbar.Delete.TYPE].button,e?L.DomUtil.removeClass(i,"leaflet-disabled"):L.DomUtil.addClass(i,"leaflet-disabled"),i.setAttribute("title",e?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(i,t){if(L.Handler.prototype.initialize.call(this,i),L.setOptions(this,t),this._featureGroup=t.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var e=L.version.split(".");parseInt(e[0],10)===1&&parseInt(e[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var i=this._map;i&&(i.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),i._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(i){this._revertLayer(i)},this)},save:function(){var i=new L.LayerGroup;this._featureGroup.eachLayer(function(t){t.edited&&(i.addLayer(t),t.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:i})},_backupLayer:function(i){var t=L.Util.stamp(i);this._uneditedLayerProps[t]||(i instanceof L.Polyline||i instanceof L.Polygon||i instanceof L.Rectangle?this._uneditedLayerProps[t]={latlngs:L.LatLngUtil.cloneLatLngs(i.getLatLngs())}:i instanceof L.Circle?this._uneditedLayerProps[t]={latlng:L.LatLngUtil.cloneLatLng(i.getLatLng()),radius:i.getRadius()}:(i instanceof L.Marker||i instanceof L.CircleMarker)&&(this._uneditedLayerProps[t]={latlng:L.LatLngUtil.cloneLatLng(i.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(i){var t=L.Util.stamp(i);i.edited=!1,this._uneditedLayerProps.hasOwnProperty(t)&&(i instanceof L.Polyline||i instanceof L.Polygon||i instanceof L.Rectangle?i.setLatLngs(this._uneditedLayerProps[t].latlngs):i instanceof L.Circle?(i.setLatLng(this._uneditedLayerProps[t].latlng),i.setRadius(this._uneditedLayerProps[t].radius)):(i instanceof L.Marker||i instanceof L.CircleMarker)&&i.setLatLng(this._uneditedLayerProps[t].latlng),i.fire("revert-edited",{layer:i}))},_enableLayerEdit:function(i){var t,e,o=i.layer||i.target||i;this._backupLayer(o),this.options.poly&&(e=L.Util.extend({},this.options.poly),o.options.poly=e),this.options.selectedPathOptions&&(t=L.Util.extend({},this.options.selectedPathOptions),t.maintainColor&&(t.color=o.options.color,t.fillColor=o.options.fillColor),o.options.original=L.extend({},o.options),o.options.editing=t),o instanceof L.Marker?(o.editing&&o.editing.enable(),o.dragging.enable(),o.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):o.editing.enable()},_disableLayerEdit:function(i){var t=i.layer||i.target||i;t.edited=!1,t.editing&&t.editing.disable(),delete t.options.editing,delete t.options.original,this._selectedPathOptions&&(t instanceof L.Marker?this._toggleMarkerHighlight(t):(t.setStyle(t.options.previousOptions),delete t.options.previousOptions)),t instanceof L.Marker?(t.dragging.disable(),t.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):t.editing.disable()},_onMouseMove:function(i){this._tooltip.updatePosition(i.latlng)},_onMarkerDragEnd:function(i){var t=i.target;t.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:t})},_onTouchMove:function(i){var t=i.originalEvent.changedTouches[0],e=this._map.mouseEventToLayerPoint(t),o=this._map.layerPointToLatLng(e);i.target.setLatLng(o)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(i,t){if(L.Handler.prototype.initialize.call(this,i),L.Util.setOptions(this,t),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var e=L.version.split(".");parseInt(e[0],10)===1&&parseInt(e[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var i=this._map;i&&(i.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(i){this._deletableLayers.addLayer(i),i.fire("revert-deleted",{layer:i})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(i){this._removeLayer({layer:i})},this),this.save()},_enableLayerDelete:function(i){(i.layer||i.target||i).on("click",this._removeLayer,this)},_disableLayerDelete:function(i){var t=i.layer||i.target||i;t.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(t)},_removeLayer:function(i){var t=i.layer||i.target||i;this._deletableLayers.removeLayer(t),this._deletedLayers.addLayer(t),t.fire("deleted")},_onMouseMove:function(i){this._tooltip.updatePosition(i.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);(function(u){if(typeof u>"u")throw new Error("Leaflet must be included first");u.Control.Layers.Tree=u.Control.Layers.extend({options:{closedSymbol:"+",openedSymbol:"&minus;",spaceSymbol:" ",selectorBack:!1,namedToggle:!1,collapseAll:"",expandAll:"",labelIsSelector:"both"},_initClassesNames:function(){this.cls={children:"leaflet-layerstree-children",childrenNopad:"leaflet-layerstree-children-nopad",hide:"leaflet-layerstree-hide",closed:"leaflet-layerstree-closed",opened:"leaflet-layerstree-opened",space:"leaflet-layerstree-header-space",pointer:"leaflet-layerstree-header-pointer",header:"leaflet-layerstree-header",neverShow:"leaflet-layerstree-nevershow",node:"leaflet-layerstree-node",name:"leaflet-layerstree-header-name",label:"leaflet-layerstree-header-label",selAllCheckbox:"leaflet-layerstree-sel-all-checkbox"}},initialize:function(h,p,l){this._scrollTop=0,this._initClassesNames(),this._baseTree=null,this._overlaysTree=null,u.Util.setOptions(this,l),u.Control.Layers.prototype.initialize.call(this,null,null,l),this._setTrees(h,p)},setBaseTree:function(h){return this._setTrees(h)},setOverlayTree:function(h){return this._setTrees(void 0,h)},addBaseLayer:function(h,p){throw"addBaseLayer is disabled"},addOverlay:function(h,p){throw"addOverlay is disabled"},removeLayer:function(h){throw"removeLayer is disabled"},collapse:function(){return this._scrollTop=this._sect().scrollTop,u.Control.Layers.prototype.collapse.call(this)},expand:function(){u.Control.Layers.prototype.expand.call(this),this._sect().scrollTop=this._scrollTop},onAdd:function(h){function p(t){t._layersTreeName&&(i.innerHTML=t._layersTreeName)}var l=u.Control.Layers.prototype.onAdd.call(this,h);if(this.options.namedToggle){var i=this._container.getElementsByClassName("leaflet-control-layers-toggle")[0];u.DomUtil.addClass(i,"leaflet-layerstree-named-toggle"),h.eachLayer(function(t){p(t)}),h.on("baselayerchange",function(t){p(t.layer)},this)}return l},expandTree:function(h){var p=h?this._overlaysList:this._baseLayersList;return p&&this._applyOnTree(p,!1),this._localExpand()},collapseTree:function(h){var p=h?this._overlaysList:this._baseLayersList;return p&&this._applyOnTree(p,!0),this._localExpand()},expandSelected:function(h){function p(r){var s=r.parentElement;if(s){if(u.DomUtil.hasClass(s,l.cls.children)&&!u.DomUtil.hasClass(r,l.cls.childrenNopad)&&u.DomUtil.removeClass(s,t),u.DomUtil.hasClass(s,l.cls.node)){var a=s.getElementsByClassName(l.cls.header)[0];l._applyOnTree(a,!1)}p(s)}}var l=this,i=h?this._overlaysList:this._baseLayersList;if(!i)return this;for(var t=this.cls.hide,e=this._layerControlInputs||i.getElementsByTagName("input"),o=0;o<e.length;o++){var n=e[o];this._getLayer&&!!this._getLayer(n.layerId).overlay!=!!h||n.checked&&p(n.parentElement.parentElement.parentElement.parentElement)}return this._localExpand()},_sect:function(){return this._section||this._form},_setTrees:function(h,p){var l=0;function i(r,s,a){return r&&r.layer&&(a||(r.layer._layersTreeName=r.name||r.label),s[l++]=r.layer),r&&r.children&&r.children.length&&r.children.forEach(function(d){i(d,s,a)}),s}function t(r){return Array.isArray(r)?{noShow:!0,children:r}:r}this._layerControlInputs&&(this._layerControlInputs=[]);for(var e=0;e<this._layers.length;++e)this._layers[e].layer.off("add remove",this._onLayerChange,this);this._layers=[],h!==void 0&&(this._baseTree=t(h)),p!==void 0&&(this._overlaysTree=t(p));var o=i(this._baseTree,{});for(var e in o)this._addLayer(o[e],e);var n=i(this._overlaysTree,{},!0);for(e in n)this._addLayer(n[e],e,!0);return this._map?this._update():this},_localExpand:function(){if(this._map&&u.DomUtil.hasClass(this._container,"leaflet-control-layers-expanded")){var h=this._sect().scrollTop;this.expand(),this._sect().scrollTop=h,this._scrollTop=h}return this},_applyOnTree:function(h,p){var l=[{cls:this.cls.children,hide:p},{cls:this.cls.opened,hide:p},{cls:this.cls.closed,hide:!p}];l.forEach(function(i){for(var t=h.getElementsByClassName(i.cls),e=0;e<t.length;e++){var o=t[e];u.DomUtil.hasClass(o,this.cls.childrenNopad)||(i.hide?u.DomUtil.addClass(o,this.cls.hide):u.DomUtil.removeClass(o,this.cls.hide))}},this)},_addItem:function(h){},_update:function(){return this._container?(u.Control.Layers.prototype._update.call(this),this._addTreeLayout(this._baseTree,!1),this._addTreeLayout(this._overlaysTree,!0),this._localExpand()):this},_addTreeLayout:function(h,p){if(h){var l=p?this._overlaysList:this._baseLayersList;this._expandCollapseAll(p,this.options.collapseAll,this.collapseTree),this._expandCollapseAll(p,this.options.expandAll,this.expandTree),this._iterateTreeLayout(h,l,p,[],h.noShow),this._checkDisabledLayers&&this._checkDisabledLayers()}},_expandCollapseAll:function(h,p,l,i){var t=h?this._overlaysList:this._baseLayersList;if(i=i||this,p){var e=document.createElement("div");e.className="leaflet-layerstree-expand-collapse",t.appendChild(e),e.innerHTML=p,e.tabIndex=0,u.DomEvent.on(e,"click keydown",function(o){(o.type!=="keydown"||o.keyCode===32)&&(e.blur(),l.call(i,h),this._localExpand())},this)}},_iterateTreeLayout:function(h,p,l,i,t){if(!h)return;function e(k,w,E,x){var G=u.DomUtil.create(k,w,E);return x&&(G.innerHTML=x),G}var o=e("div",this.cls.header,p),n=e("span"),r=e("span"),s=e("span",this.cls.closed,n,this.options.closedSymbol),a=e("span",this.cls.opened,n,this.options.openedSymbol),d=e("span",this.cls.space,null,this.options.spaceSymbol);this.options.selectorBack?(n.insertBefore(d,s),o.appendChild(r),o.appendChild(n)):(n.appendChild(d),o.appendChild(n),o.appendChild(r));function c(k){var w=k.querySelector("input[type=checkbox]"),E=!0,x=!0,G=k.querySelectorAll("input[type=checkbox]");[].forEach.call(G,function(H){H===w||(H.indeterminate?(E=!1,x=!1):H.checked?x=!1:H.checked||(E=!1))}),E?(w.indeterminate=!1,w.checked=!0):x?(w.indeterminate=!1,w.checked=!1):(w.indeterminate=!0,w.checked=!1)}function f(k,w){i.forEach(function(E){u.DomEvent.on(k,"click",function(x){c(E)},w)},w)}var _;h.selectAllCheckbox&&(_=this._createCheckboxElement(!1),_.className+=" "+this.cls.selAllCheckbox);var g=this.cls.hide;if(h.children){var m=e("div",this.cls.children,p),y=h.layer?n:o;u.DomUtil.addClass(y,this.cls.pointer),y.tabIndex=0,u.DomEvent.on(y,"click keydown",function(k){k.type==="keydown"&&k.keyCode!==32||(y.blur(),u.DomUtil.hasClass(a,g)?(u.DomUtil.addClass(s,g),u.DomUtil.removeClass(a,g),u.DomUtil.removeClass(m,g)):(u.DomUtil.removeClass(s,g),u.DomUtil.addClass(a,g),u.DomUtil.addClass(m,g)),this._localExpand())},this),_&&i.splice(0,0,p),h.children.forEach(function(k){var w=e("div",this.cls.node,m);this._iterateTreeLayout(k,w,l,i)},this),_&&i.splice(0,1)}else u.DomUtil.addClass(n,this.cls.neverShow);var M;h.layer&&(this.options.labelIsSelector==="both"||l&&this.options.labelIsSelector==="overlay"||!l&&this.options.labelIsSelector==="base")?M="label":M="span";var D=e(M,this.cls.label,r);if(h.layer){var T=this._map.hasLayer(h.layer),S,q=l?h.radioGroup:"leaflet-base-layers_"+u.Util.stamp(this);q?S=this._createRadioElement(q,T):(S=this._createCheckboxElement(T),f(S,this)),this._layerControlInputs&&this._layerControlInputs.push(S),S.layerId=u.Util.stamp(h.layer),u.DomEvent.on(S,"click",this._onInputClick,this),D.appendChild(S)}function K(k){return typeof k=="string"||k instanceof String}function tt(k){return k&&{}.toString.call(k)==="[object Function]"}function $(k,w){for(var E=p.getElementsByTagName("input"),x=0;x<E.length;x++){var G=E[x];G.type==="checkbox"&&(G.checked=k,G.indeterminate=!1)}w._onInputClick()}h.selectAllCheckbox&&(D.appendChild(_),K(h.selectAllCheckbox)&&(_.title=h.selectAllCheckbox),u.DomEvent.on(_,"click",function(k){k.stopPropagation(),$(_.checked,this)},this),c(p),f(_,this)),e("span",this.cls.name,D,h.label),u.DomUtil.addClass(h.collapsed?a:s,g),h.collapsed&&m&&u.DomUtil.addClass(m,g),t&&(u.DomUtil.addClass(o,this.cls.neverShow),u.DomUtil.addClass(m,this.cls.childrenNopad));var B=h.eventedClasses;B instanceof Array||(B=[B]);for(var A=0;A<B.length;A++){var U=B[A];if(U&&U.className){var N=p.querySelector("."+U.className);N&&u.DomEvent.on(N,U.event||"click",function(k){return function(w){w.stopPropagation();var E=tt(k)?k(w,p,h,this._map):k;E!=null&&$(E,this)}}(U.selectAll),this)}}},_createCheckboxElement:function(h){var p=document.createElement("input");return p.type="checkbox",p.className="leaflet-control-layers-selector",p.defaultChecked=h,p}}),u.control.layers.tree=function(h,p,l){return new u.Control.Layers.Tree(h,p,l)}})(L);function I(u,h,p,l,i){let t,e,o;switch(l){case"top":t="absolute top-16 centrear-w-absolute !w-10/12 sm:!w-1/2";break;case"bottom":t="absolute bottom-24 centrear-w-absolute !w-10/12 sm:!w-1/2";break;case"center":t="absolute centrearXY !w-10/12 sm:!w-1/2";break;default:t=""}switch(i){case"success":e="alert-success",o='<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>';break;case"warning":e="alert-warning",o='<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>';break;case"error":e="alert-error",o='<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>';break;default:e="",o=""}const n=document.createElement("div");n.id=u,n.innerHTML=`
      <div role="alert" class="alert w-1/2 ${e} z-[1500] ${t}">
        ${o}
        <span>${p}</span>
      </div>`,document.getElementById(h)?document.getElementById(h).appendChild(n):document.body.appendChild(n),setTimeout(()=>{n.remove()},5e3)}var at={exports:{}};(function(u,h){(function(p,l){l(h)})(dt,function(p){var l=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(t){L.Util.setOptions(this,t),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var e=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,e?this._withAnimation:this._noAnimation),this._markerCluster=e?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(t){if(t instanceof L.LayerGroup)return this.addLayers([t]);if(!t.getLatLng)return this._nonPointGroup.addLayer(t),this.fire("layeradd",{layer:t}),this;if(!this._map)return this._needsClustering.push(t),this.fire("layeradd",{layer:t}),this;if(this.hasLayer(t))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(t,this._maxZoom),this.fire("layeradd",{layer:t}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var e=t,o=this._zoom;if(t.__parent)for(;e.__parent._zoom>=o;)e=e.__parent;return this._currentShownBounds.contains(e.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(t,e):this._animationAddLayerNonAnimated(t,e)),this},removeLayer:function(t){return t instanceof L.LayerGroup?this.removeLayers([t]):t.getLatLng?this._map?t.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(t)),this._removeLayer(t,!0),this.fire("layerremove",{layer:t}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),t.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(t)&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,t)&&this.hasLayer(t)&&this._needsRemoving.push({layer:t,latlng:t._latlng}),this.fire("layerremove",{layer:t}),this):(this._nonPointGroup.removeLayer(t),this.fire("layerremove",{layer:t}),this)},addLayers:function(t,e){if(!L.Util.isArray(t))return this.addLayer(t);var o=this._featureGroup,n=this._nonPointGroup,r=this.options.chunkedLoading,s=this.options.chunkInterval,a=this.options.chunkProgress,d=t.length,c=0,f=!0,_;if(this._map){var g=new Date().getTime(),m=L.bind(function(){var M=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();c<d;c++){if(r&&c%200===0){var D=new Date().getTime()-M;if(D>s)break}if(_=t[c],_ instanceof L.LayerGroup){f&&(t=t.slice(),f=!1),this._extractNonGroupLayers(_,t),d=t.length;continue}if(!_.getLatLng){n.addLayer(_),e||this.fire("layeradd",{layer:_});continue}if(!this.hasLayer(_)&&(this._addLayer(_,this._maxZoom),e||this.fire("layeradd",{layer:_}),_.__parent&&_.__parent.getChildCount()===2)){var T=_.__parent.getAllChildMarkers(),S=T[0]===_?T[1]:T[0];o.removeLayer(S)}}a&&a(c,d,new Date().getTime()-g),c===d?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(m,this.options.chunkDelay)},this);m()}else for(var y=this._needsClustering;c<d;c++){if(_=t[c],_ instanceof L.LayerGroup){f&&(t=t.slice(),f=!1),this._extractNonGroupLayers(_,t),d=t.length;continue}if(!_.getLatLng){n.addLayer(_);continue}this.hasLayer(_)||y.push(_)}return this},removeLayers:function(t){var e,o,n=t.length,r=this._featureGroup,s=this._nonPointGroup,a=!0;if(!this._map){for(e=0;e<n;e++){if(o=t[e],o instanceof L.LayerGroup){a&&(t=t.slice(),a=!1),this._extractNonGroupLayers(o,t),n=t.length;continue}this._arraySplice(this._needsClustering,o),s.removeLayer(o),this.hasLayer(o)&&this._needsRemoving.push({layer:o,latlng:o._latlng}),this.fire("layerremove",{layer:o})}return this}if(this._unspiderfy){this._unspiderfy();var d=t.slice(),c=n;for(e=0;e<c;e++){if(o=d[e],o instanceof L.LayerGroup){this._extractNonGroupLayers(o,d),c=d.length;continue}this._unspiderfyLayer(o)}}for(e=0;e<n;e++){if(o=t[e],o instanceof L.LayerGroup){a&&(t=t.slice(),a=!1),this._extractNonGroupLayers(o,t),n=t.length;continue}if(!o.__parent){s.removeLayer(o),this.fire("layerremove",{layer:o});continue}this._removeLayer(o,!0,!0),this.fire("layerremove",{layer:o}),r.hasLayer(o)&&(r.removeLayer(o),o.clusterShow&&o.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(t){t.off(this._childMarkerEventHandlers,this),delete t.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var t=new L.LatLngBounds;this._topClusterLevel&&t.extend(this._topClusterLevel._bounds);for(var e=this._needsClustering.length-1;e>=0;e--)t.extend(this._needsClustering[e].getLatLng());return t.extend(this._nonPointGroup.getBounds()),t},eachLayer:function(t,e){var o=this._needsClustering.slice(),n=this._needsRemoving,r,s,a;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(o),s=o.length-1;s>=0;s--){for(r=!0,a=n.length-1;a>=0;a--)if(n[a].layer===o[s]){r=!1;break}r&&t.call(e,o[s])}this._nonPointGroup.eachLayer(t,e)},getLayers:function(){var t=[];return this.eachLayer(function(e){t.push(e)}),t},getLayer:function(t){var e=null;return t=parseInt(t,10),this.eachLayer(function(o){L.stamp(o)===t&&(e=o)}),e},hasLayer:function(t){if(!t)return!1;var e,o=this._needsClustering;for(e=o.length-1;e>=0;e--)if(o[e]===t)return!0;for(o=this._needsRemoving,e=o.length-1;e>=0;e--)if(o[e].layer===t)return!1;return!!(t.__parent&&t.__parent._group===this)||this._nonPointGroup.hasLayer(t)},zoomToShowLayer:function(t,e){var o=this._map;typeof e!="function"&&(e=function(){});var n=function(){(o.hasLayer(t)||o.hasLayer(t.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",n,this),this.off("animationend",n,this),o.hasLayer(t)?e():t.__parent._icon&&(this.once("spiderfied",e,this),t.__parent.spiderfy()))};t._icon&&this._map.getBounds().contains(t.getLatLng())?e():t.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",n,this),this._map.panTo(t.getLatLng())):(this._map.on("moveend",n,this),this.on("animationend",n,this),t.__parent.zoomToBounds())},onAdd:function(t){this._map=t;var e,o,n;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(t),this._nonPointGroup.addTo(t),this._gridClusters||this._generateInitialClusters(),this._maxLat=t.options.crs.projection.MAX_LATITUDE,e=0,o=this._needsRemoving.length;e<o;e++)n=this._needsRemoving[e],n.newlatlng=n.layer._latlng,n.layer._latlng=n.latlng;for(e=0,o=this._needsRemoving.length;e<o;e++)n=this._needsRemoving[e],this._removeLayer(n.layer,!0),n.layer._latlng=n.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),o=this._needsClustering,this._needsClustering=[],this.addLayers(o,!0)},onRemove:function(t){t.off("zoomend",this._zoomEnd,this),t.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(t){for(var e=t;e&&!e._icon;)e=e.__parent;return e||null},_arraySplice:function(t,e){for(var o=t.length-1;o>=0;o--)if(t[o]===e)return t.splice(o,1),!0},_removeFromGridUnclustered:function(t,e){for(var o=this._map,n=this._gridUnclustered,r=Math.floor(this._map.getMinZoom());e>=r&&n[e].removeObject(t,o.project(t.getLatLng(),e));e--);},_childMarkerDragStart:function(t){t.target.__dragStart=t.target._latlng},_childMarkerMoved:function(t){if(!this._ignoreMove&&!t.target.__dragStart){var e=t.target._popup&&t.target._popup.isOpen();this._moveChild(t.target,t.oldLatLng,t.latlng),e&&t.target.openPopup()}},_moveChild:function(t,e,o){t._latlng=e,this.removeLayer(t),t._latlng=o,this.addLayer(t)},_childMarkerDragEnd:function(t){var e=t.target.__dragStart;delete t.target.__dragStart,e&&this._moveChild(t.target,e,t.target._latlng)},_removeLayer:function(t,e,o){var n=this._gridClusters,r=this._gridUnclustered,s=this._featureGroup,a=this._map,d=Math.floor(this._map.getMinZoom());e&&this._removeFromGridUnclustered(t,this._maxZoom);var c=t.__parent,f=c._markers,_;for(this._arraySplice(f,t);c&&(c._childCount--,c._boundsNeedUpdate=!0,!(c._zoom<d));)e&&c._childCount<=1?(_=c._markers[0]===t?c._markers[1]:c._markers[0],n[c._zoom].removeObject(c,a.project(c._cLatLng,c._zoom)),r[c._zoom].addObject(_,a.project(_.getLatLng(),c._zoom)),this._arraySplice(c.__parent._childClusters,c),c.__parent._markers.push(_),_.__parent=c.__parent,c._icon&&(s.removeLayer(c),o||s.addLayer(_))):c._iconNeedsUpdate=!0,c=c.__parent;delete t.__parent},_isOrIsParent:function(t,e){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},fire:function(t,e,o){if(e&&e.layer instanceof L.MarkerCluster){if(e.originalEvent&&this._isOrIsParent(e.layer._icon,e.originalEvent.relatedTarget))return;t="cluster"+t}L.FeatureGroup.prototype.fire.call(this,t,e,o)},listens:function(t,e){return L.FeatureGroup.prototype.listens.call(this,t,e)||L.FeatureGroup.prototype.listens.call(this,"cluster"+t,e)},_defaultIconCreateFunction:function(t){var e=t.getChildCount(),o=" marker-cluster-";return e<10?o+="small":e<100?o+="medium":o+="large",new L.DivIcon({html:"<div><span>"+e+"</span></div>",className:"marker-cluster"+o,iconSize:new L.Point(40,40)})},_bindEvents:function(){var t=this._map,e=this.options.spiderfyOnMaxZoom,o=this.options.showCoverageOnHover,n=this.options.zoomToBoundsOnClick,r=this.options.spiderfyOnEveryZoom;(e||n||r)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),o&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),t.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(t){var e=t.layer,o=e;if(!(t.type==="clusterkeypress"&&t.originalEvent&&t.originalEvent.keyCode!==13)){for(;o._childClusters.length===1;)o=o._childClusters[0];o._zoom===this._maxZoom&&o._childCount===e._childCount&&this.options.spiderfyOnMaxZoom?e.spiderfy():this.options.zoomToBoundsOnClick&&e.zoomToBounds(),this.options.spiderfyOnEveryZoom&&e.spiderfy(),t.originalEvent&&t.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(t){var e=this._map;this._inZoomAnimation||(this._shownPolygon&&e.removeLayer(this._shownPolygon),t.layer.getChildCount()>2&&t.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(t.layer.getConvexHull(),this.options.polygonOptions),e.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var t=this.options.spiderfyOnMaxZoom,e=this.options.showCoverageOnHover,o=this.options.zoomToBoundsOnClick,n=this.options.spiderfyOnEveryZoom,r=this._map;(t||o||n)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),e&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),r.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var t=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),t),this._currentShownBounds=t}},_generateInitialClusters:function(){var t=Math.ceil(this._map.getMaxZoom()),e=Math.floor(this._map.getMinZoom()),o=this.options.maxClusterRadius,n=o;typeof o!="function"&&(n=function(){return o}),this.options.disableClusteringAtZoom!==null&&(t=this.options.disableClusteringAtZoom-1),this._maxZoom=t,this._gridClusters={},this._gridUnclustered={};for(var r=t;r>=e;r--)this._gridClusters[r]=new L.DistanceGrid(n(r)),this._gridUnclustered[r]=new L.DistanceGrid(n(r));this._topClusterLevel=new this._markerCluster(this,e-1)},_addLayer:function(t,e){var o=this._gridClusters,n=this._gridUnclustered,r=Math.floor(this._map.getMinZoom()),s,a;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(t),t.on(this._childMarkerEventHandlers,this);e>=r;e--){s=this._map.project(t.getLatLng(),e);var d=o[e].getNearObject(s);if(d){d._addChild(t),t.__parent=d;return}if(d=n[e].getNearObject(s),d){var c=d.__parent;c&&this._removeLayer(d,!1);var f=new this._markerCluster(this,e,d,t);o[e].addObject(f,this._map.project(f._cLatLng,e)),d.__parent=f,t.__parent=f;var _=f;for(a=e-1;a>c._zoom;a--)_=new this._markerCluster(this,a,_),o[a].addObject(_,this._map.project(d.getLatLng(),a));c._addChild(_),this._removeFromGridUnclustered(d,e);return}n[e].addObject(t,s)}this._topClusterLevel._addChild(t),t.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(t){t instanceof L.MarkerCluster&&t._iconNeedsUpdate&&t._updateIcon()})},_enqueue:function(t){this._queue.push(t),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var t=0;t<this._queue.length;t++)this._queue[t].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var t=Math.round(this._map._zoom);this._processQueue(),this._zoom<t&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,t)):this._zoom>t?(this._animationStart(),this._animationZoomOut(this._zoom,t)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(t){var e=this._maxLat;return e!==void 0&&(t.getNorth()>=e&&(t._northEast.lat=1/0),t.getSouth()<=-e&&(t._southWest.lat=-1/0)),t},_animationAddLayerNonAnimated:function(t,e){if(e===t)this._featureGroup.addLayer(t);else if(e._childCount===2){e._addToMap();var o=e.getAllChildMarkers();this._featureGroup.removeLayer(o[0]),this._featureGroup.removeLayer(o[1])}else e._updateIcon()},_extractNonGroupLayers:function(t,e){var o=t.getLayers(),n=0,r;for(e=e||[];n<o.length;n++){if(r=o[n],r instanceof L.LayerGroup){this._extractNonGroupLayers(r,e);continue}e.push(r)}return e},_overrideMarkerIcon:function(t){var e=t.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[t]}});return e}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(t,e){this._animationAddLayerNonAnimated(t,e)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(t,e){var o=this._getExpandedVisibleBounds(),n=this._featureGroup,r=Math.floor(this._map.getMinZoom()),s;this._ignoreMove=!0,this._topClusterLevel._recursively(o,t,r,function(a){var d=a._latlng,c=a._markers,f;for(o.contains(d)||(d=null),a._isSingleParent()&&t+1===e?(n.removeLayer(a),a._recursivelyAddChildrenToMap(null,e,o)):(a.clusterHide(),a._recursivelyAddChildrenToMap(d,e,o)),s=c.length-1;s>=0;s--)f=c[s],o.contains(f._latlng)||n.removeLayer(f)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(o,e),n.eachLayer(function(a){!(a instanceof L.MarkerCluster)&&a._icon&&a.clusterShow()}),this._topClusterLevel._recursively(o,t,e,function(a){a._recursivelyRestoreChildPositions(e)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(o,t,r,function(a){n.removeLayer(a),a.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(t,e){this._animationZoomOutSingle(this._topClusterLevel,t-1,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t,this._getExpandedVisibleBounds())},_animationAddLayer:function(t,e){var o=this,n=this._featureGroup;n.addLayer(t),e!==t&&(e._childCount>2?(e._updateIcon(),this._forceLayout(),this._animationStart(),t._setPos(this._map.latLngToLayerPoint(e.getLatLng())),t.clusterHide(),this._enqueue(function(){n.removeLayer(t),t.clusterShow(),o._animationEnd()})):(this._forceLayout(),o._animationStart(),o._animationZoomOutSingle(e,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(t,e,o){var n=this._getExpandedVisibleBounds(),r=Math.floor(this._map.getMinZoom());t._recursivelyAnimateChildrenInAndAddSelfToMap(n,r,e+1,o);var s=this;this._forceLayout(),t._recursivelyBecomeVisible(n,o),this._enqueue(function(){if(t._childCount===1){var a=t._markers[0];this._ignoreMove=!0,a.setLatLng(a.getLatLng()),this._ignoreMove=!1,a.clusterShow&&a.clusterShow()}else t._recursively(n,o,r,function(d){d._recursivelyRemoveChildrenFromMap(n,r,e+1)});s._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(t){return new L.MarkerClusterGroup(t)};var i=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(t,e,o,n){L.Marker.prototype.initialize.call(this,o?o._cLatLng||o.getLatLng():new L.LatLng(0,0),{icon:this,pane:t.options.clusterPane}),this._group=t,this._zoom=e,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,o&&this._addChild(o),n&&this._addChild(n)},getAllChildMarkers:function(t,e){t=t||[];for(var o=this._childClusters.length-1;o>=0;o--)this._childClusters[o].getAllChildMarkers(t,e);for(var n=this._markers.length-1;n>=0;n--)e&&this._markers[n].__dragStart||t.push(this._markers[n]);return t},getChildCount:function(){return this._childCount},zoomToBounds:function(t){for(var e=this._childClusters.slice(),o=this._group._map,n=o.getBoundsZoom(this._bounds),r=this._zoom+1,s=o.getZoom(),a;e.length>0&&n>r;){r++;var d=[];for(a=0;a<e.length;a++)d=d.concat(e[a]._childClusters);e=d}n>r?this._group._map.setView(this._latlng,r):n<=s?this._group._map.setView(this._latlng,s+1):this._group._map.fitBounds(this._bounds,t)},getBounds:function(){var t=new L.LatLngBounds;return t.extend(this._bounds),t},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(t,e){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(t),t instanceof L.MarkerCluster?(e||(this._childClusters.push(t),t.__parent=this),this._childCount+=t._childCount):(e||this._markers.push(t),this._childCount++),this.__parent&&this.__parent._addChild(t,!0)},_setClusterCenter:function(t){this._cLatLng||(this._cLatLng=t._cLatLng||t._latlng)},_resetBounds:function(){var t=this._bounds;t._southWest&&(t._southWest.lat=1/0,t._southWest.lng=1/0),t._northEast&&(t._northEast.lat=-1/0,t._northEast.lng=-1/0)},_recalculateBounds:function(){var t=this._markers,e=this._childClusters,o=0,n=0,r=this._childCount,s,a,d,c;if(r!==0){for(this._resetBounds(),s=0;s<t.length;s++)d=t[s]._latlng,this._bounds.extend(d),o+=d.lat,n+=d.lng;for(s=0;s<e.length;s++)a=e[s],a._boundsNeedUpdate&&a._recalculateBounds(),this._bounds.extend(a._bounds),d=a._wLatLng,c=a._childCount,o+=d.lat*c,n+=d.lng*c;this._latlng=this._wLatLng=new L.LatLng(o/r,n/r),this._boundsNeedUpdate=!1}},_addToMap:function(t){t&&(this._backupLatlng=this._latlng,this.setLatLng(t)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(t,e,o){this._recursively(t,this._group._map.getMinZoom(),o-1,function(n){var r=n._markers,s,a;for(s=r.length-1;s>=0;s--)a=r[s],a._icon&&(a._setPos(e),a.clusterHide())},function(n){var r=n._childClusters,s,a;for(s=r.length-1;s>=0;s--)a=r[s],a._icon&&(a._setPos(e),a.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(t,e,o,n){this._recursively(t,n,e,function(r){r._recursivelyAnimateChildrenIn(t,r._group._map.latLngToLayerPoint(r.getLatLng()).round(),o),r._isSingleParent()&&o-1===n?(r.clusterShow(),r._recursivelyRemoveChildrenFromMap(t,e,o)):r.clusterHide(),r._addToMap()})},_recursivelyBecomeVisible:function(t,e){this._recursively(t,this._group._map.getMinZoom(),e,null,function(o){o.clusterShow()})},_recursivelyAddChildrenToMap:function(t,e,o){this._recursively(o,this._group._map.getMinZoom()-1,e,function(n){if(e!==n._zoom)for(var r=n._markers.length-1;r>=0;r--){var s=n._markers[r];o.contains(s._latlng)&&(t&&(s._backupLatlng=s.getLatLng(),s.setLatLng(t),s.clusterHide&&s.clusterHide()),n._group._featureGroup.addLayer(s))}},function(n){n._addToMap(t)})},_recursivelyRestoreChildPositions:function(t){for(var e=this._markers.length-1;e>=0;e--){var o=this._markers[e];o._backupLatlng&&(o.setLatLng(o._backupLatlng),delete o._backupLatlng)}if(t-1===this._zoom)for(var n=this._childClusters.length-1;n>=0;n--)this._childClusters[n]._restorePosition();else for(var r=this._childClusters.length-1;r>=0;r--)this._childClusters[r]._recursivelyRestoreChildPositions(t)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(t,e,o,n){var r,s;this._recursively(t,e-1,o-1,function(a){for(s=a._markers.length-1;s>=0;s--)r=a._markers[s],(!n||!n.contains(r._latlng))&&(a._group._featureGroup.removeLayer(r),r.clusterShow&&r.clusterShow())},function(a){for(s=a._childClusters.length-1;s>=0;s--)r=a._childClusters[s],(!n||!n.contains(r._latlng))&&(a._group._featureGroup.removeLayer(r),r.clusterShow&&r.clusterShow())})},_recursively:function(t,e,o,n,r){var s=this._childClusters,a=this._zoom,d,c;if(e<=a&&(n&&n(this),r&&a===o&&r(this)),a<e||a<o)for(d=s.length-1;d>=0;d--)c=s[d],c._boundsNeedUpdate&&c._recalculateBounds(),t.intersects(c._bounds)&&c._recursively(t,e,o,n,r)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var t=this.options.opacity;return this.setOpacity(0),this.options.opacity=t,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(t){this._cellSize=t,this._sqCellSize=t*t,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(t,e){var o=this._getCoord(e.x),n=this._getCoord(e.y),r=this._grid,s=r[n]=r[n]||{},a=s[o]=s[o]||[],d=L.Util.stamp(t);this._objectPoint[d]=e,a.push(t)},updateObject:function(t,e){this.removeObject(t),this.addObject(t,e)},removeObject:function(t,e){var o=this._getCoord(e.x),n=this._getCoord(e.y),r=this._grid,s=r[n]=r[n]||{},a=s[o]=s[o]||[],d,c;for(delete this._objectPoint[L.Util.stamp(t)],d=0,c=a.length;d<c;d++)if(a[d]===t)return a.splice(d,1),c===1&&delete s[o],!0},eachObject:function(t,e){var o,n,r,s,a,d,c,f=this._grid;for(o in f){a=f[o];for(n in a)for(d=a[n],r=0,s=d.length;r<s;r++)c=t.call(e,d[r]),c&&(r--,s--)}},getNearObject:function(t){var e=this._getCoord(t.x),o=this._getCoord(t.y),n,r,s,a,d,c,f,_,g=this._objectPoint,m=this._sqCellSize,y=null;for(n=o-1;n<=o+1;n++)if(a=this._grid[n],a){for(r=e-1;r<=e+1;r++)if(d=a[r],d)for(s=0,c=d.length;s<c;s++)f=d[s],_=this._sqDist(g[L.Util.stamp(f)],t),(_<m||_<=m&&y===null)&&(m=_,y=f)}return y},_getCoord:function(t){var e=Math.floor(t/this._cellSize);return isFinite(e)?e:t},_sqDist:function(t,e){var o=e.x-t.x,n=e.y-t.y;return o*o+n*n}},function(){L.QuickHull={getDistant:function(t,e){var o=e[1].lat-e[0].lat,n=e[0].lng-e[1].lng;return n*(t.lat-e[0].lat)+o*(t.lng-e[0].lng)},findMostDistantPointFromBaseLine:function(t,e){var o=0,n=null,r=[],s,a,d;for(s=e.length-1;s>=0;s--){if(a=e[s],d=this.getDistant(a,t),d>0)r.push(a);else continue;d>o&&(o=d,n=a)}return{maxPoint:n,newPoints:r}},buildConvexHull:function(t,e){var o=[],n=this.findMostDistantPointFromBaseLine(t,e);return n.maxPoint?(o=o.concat(this.buildConvexHull([t[0],n.maxPoint],n.newPoints)),o=o.concat(this.buildConvexHull([n.maxPoint,t[1]],n.newPoints)),o):[t[0]]},getConvexHull:function(t){var e=!1,o=!1,n=!1,r=!1,s=null,a=null,d=null,c=null,f=null,_=null,g;for(g=t.length-1;g>=0;g--){var m=t[g];(e===!1||m.lat>e)&&(s=m,e=m.lat),(o===!1||m.lat<o)&&(a=m,o=m.lat),(n===!1||m.lng>n)&&(d=m,n=m.lng),(r===!1||m.lng<r)&&(c=m,r=m.lng)}o!==e?(_=a,f=s):(_=c,f=d);var y=[].concat(this.buildConvexHull([_,f],t),this.buildConvexHull([f,_],t));return y}}}(),L.MarkerCluster.include({getConvexHull:function(){var t=this.getAllChildMarkers(),e=[],o,n;for(n=t.length-1;n>=0;n--)o=t[n].getLatLng(),e.push(o);return L.QuickHull.getConvexHull(e)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var t=this.getAllChildMarkers(null,!0),e=this._group,o=e._map,n=o.latLngToLayerPoint(this._latlng),r;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?r=this._group.options.spiderfyShapePositions(t.length,n):t.length>=this._circleSpiralSwitchover?r=this._generatePointsSpiral(t.length,n):(n.y+=10,r=this._generatePointsCircle(t.length,n)),this._animationSpiderfy(t,r)}},unspiderfy:function(t){this._group._inZoomAnimation||(this._animationUnspiderfy(t),this._group._spiderfied=null)},_generatePointsCircle:function(t,e){var o=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+t),n=o/this._2PI,r=this._2PI/t,s=[],a,d;for(n=Math.max(n,35),s.length=t,a=0;a<t;a++)d=this._circleStartAngle+a*r,s[a]=new L.Point(e.x+n*Math.cos(d),e.y+n*Math.sin(d))._round();return s},_generatePointsSpiral:function(t,e){var o=this._group.options.spiderfyDistanceMultiplier,n=o*this._spiralLengthStart,r=o*this._spiralFootSeparation,s=o*this._spiralLengthFactor*this._2PI,a=0,d=[],c;for(d.length=t,c=t;c>=0;c--)c<t&&(d[c]=new L.Point(e.x+n*Math.cos(a),e.y+n*Math.sin(a))._round()),a+=r/n+c*5e-4,n+=s/a;return d},_noanimationUnspiderfy:function(){var t=this._group,e=t._map,o=t._featureGroup,n=this.getAllChildMarkers(null,!0),r,s;for(t._ignoreMove=!0,this.setOpacity(1),s=n.length-1;s>=0;s--)r=n[s],o.removeLayer(r),r._preSpiderfyLatlng&&(r.setLatLng(r._preSpiderfyLatlng),delete r._preSpiderfyLatlng),r.setZIndexOffset&&r.setZIndexOffset(0),r._spiderLeg&&(e.removeLayer(r._spiderLeg),delete r._spiderLeg);t.fire("unspiderfied",{cluster:this,markers:n}),t._ignoreMove=!1,t._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(t,e){var o=this._group,n=o._map,r=o._featureGroup,s=this._group.options.spiderLegPolylineOptions,a,d,c,f;for(o._ignoreMove=!0,a=0;a<t.length;a++)f=n.layerPointToLatLng(e[a]),d=t[a],c=new L.Polyline([this._latlng,f],s),n.addLayer(c),d._spiderLeg=c,d._preSpiderfyLatlng=d._latlng,d.setLatLng(f),d.setZIndexOffset&&d.setZIndexOffset(1e6),r.addLayer(d);this.setOpacity(.3),o._ignoreMove=!1,o.fire("spiderfied",{cluster:this,markers:t})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(t,e){var o=this,n=this._group,r=n._map,s=n._featureGroup,a=this._latlng,d=r.latLngToLayerPoint(a),c=L.Path.SVG,f=L.extend({},this._group.options.spiderLegPolylineOptions),_=f.opacity,g,m,y,M,D,T;for(_===void 0&&(_=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),c?(f.opacity=0,f.className=(f.className||"")+" leaflet-cluster-spider-leg"):f.opacity=_,n._ignoreMove=!0,g=0;g<t.length;g++)m=t[g],T=r.layerPointToLatLng(e[g]),y=new L.Polyline([a,T],f),r.addLayer(y),m._spiderLeg=y,c&&(M=y._path,D=M.getTotalLength()+.1,M.style.strokeDasharray=D,M.style.strokeDashoffset=D),m.setZIndexOffset&&m.setZIndexOffset(1e6),m.clusterHide&&m.clusterHide(),s.addLayer(m),m._setPos&&m._setPos(d);for(n._forceLayout(),n._animationStart(),g=t.length-1;g>=0;g--)T=r.layerPointToLatLng(e[g]),m=t[g],m._preSpiderfyLatlng=m._latlng,m.setLatLng(T),m.clusterShow&&m.clusterShow(),c&&(y=m._spiderLeg,M=y._path,M.style.strokeDashoffset=0,y.setStyle({opacity:_}));this.setOpacity(.3),n._ignoreMove=!1,setTimeout(function(){n._animationEnd(),n.fire("spiderfied",{cluster:o,markers:t})},200)},_animationUnspiderfy:function(t){var e=this,o=this._group,n=o._map,r=o._featureGroup,s=t?n._latLngToNewLayerPoint(this._latlng,t.zoom,t.center):n.latLngToLayerPoint(this._latlng),a=this.getAllChildMarkers(null,!0),d=L.Path.SVG,c,f,_,g,m,y;for(o._ignoreMove=!0,o._animationStart(),this.setOpacity(1),f=a.length-1;f>=0;f--)c=a[f],c._preSpiderfyLatlng&&(c.closePopup(),c.setLatLng(c._preSpiderfyLatlng),delete c._preSpiderfyLatlng,y=!0,c._setPos&&(c._setPos(s),y=!1),c.clusterHide&&(c.clusterHide(),y=!1),y&&r.removeLayer(c),d&&(_=c._spiderLeg,g=_._path,m=g.getTotalLength()+.1,g.style.strokeDashoffset=m,_.setStyle({opacity:0})));o._ignoreMove=!1,setTimeout(function(){var M=0;for(f=a.length-1;f>=0;f--)c=a[f],c._spiderLeg&&M++;for(f=a.length-1;f>=0;f--)c=a[f],c._spiderLeg&&(c.clusterShow&&c.clusterShow(),c.setZIndexOffset&&c.setZIndexOffset(0),M>1&&r.removeLayer(c),n.removeLayer(c._spiderLeg),delete c._spiderLeg);o._animationEnd(),o.fire("unspiderfied",{cluster:e,markers:a})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(t){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(t))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(t){this._spiderfied&&this._spiderfied.unspiderfy(t)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(t){t._spiderLeg&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow(),t.setZIndexOffset&&t.setZIndexOffset(0),this._map.removeLayer(t._spiderLeg),delete t._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(t){return t?t instanceof L.MarkerClusterGroup?t=t._topClusterLevel.getAllChildMarkers():t instanceof L.LayerGroup?t=t._layers:t instanceof L.MarkerCluster?t=t.getAllChildMarkers():t instanceof L.Marker&&(t=[t]):t=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(t),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(t),this},_flagParentsIconsNeedUpdate:function(t){var e,o;for(e in t)for(o=t[e].__parent;o;)o._iconNeedsUpdate=!0,o=o.__parent},_refreshSingleMarkerModeMarkers:function(t){var e,o;for(e in t)o=t[e],this.hasLayer(o)&&o.setIcon(this._overrideMarkerIcon(o))}}),L.Marker.include({refreshIconOptions:function(t,e){var o=this.options.icon;return L.setOptions(o,t),this.setIcon(o),e&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),p.MarkerClusterGroup=l,p.MarkerCluster=i,Object.defineProperty(p,"__esModule",{value:!0})})})(at,at.exports);let Mt=[],Et=[],xt=[],Tt=[],Dt=[],St=[],Pt=[],It=[],Ot=[],Gt=[],At=[];const Ut=["#ffff00","#fba657","#4ade80","#52b551","#ff0000","#00ffff","#50dbff","#5eb9fc","#6199ee","#808080","black"],zt="https://be.pozosscz.com/api/v1/clientes/";let Rt=v.layerGroup(),Bt=v.layerGroup(),Ht=v.layerGroup(),Nt=v.layerGroup(),Ft=v.layerGroup(),Zt=v.layerGroup(),jt=v.layerGroup(),Vt=v.layerGroup(),Yt=v.layerGroup(),qt=v.layerGroup(),ct=v.layerGroup(),ut=v.layerGroup(),pt=v.layerGroup(),$t=v.layerGroup(),et=[Rt,Bt,Ht,Nt,Ft,Zt,jt,Vt,Yt,qt,$t],Wt=[ct,ut,pt];var Xt=function(u){return{fillColor:Ut[u],radius:8,stroke:!0,color:"black",weight:2,opacity:1,fillOpacity:1}};async function Jt(){const u=await fetch(zt).then(l=>l.json()).then(l=>l).catch(l=>{throw console.error("Error:",l),l});let h,p;return u.forEach(l=>{switch(h=l.cost/100,h<=3?h=0:h<5?(h=Math.round(h*2)/2,h=h<=3.5?1:h===4?2:3):h<10?h=Math.trunc(h)-1:h=9,h){case 0:Mt.push([l.lat,l.lon,l.cost,l.status,l.user,l.tel1,l.name,l.updated_at]);break;case 1:Et.push([l.lat,l.lon,l.cost,l.status,l.user,l.tel1,l.name,l.updated_at]);break;case 2:xt.push([l.lat,l.lon,l.cost,l.status,l.user,l.tel1,l.name,l.updated_at]);break;case 3:Tt.push([l.lat,l.lon,l.cost,l.status,l.user,l.tel1,l.name,l.updated_at]);break;case 4:Dt.push([l.lat,l.lon,l.cost,l.status,l.user,l.tel1,l.name,l.updated_at]);break;case 5:St.push([l.lat,l.lon,l.cost,l.status,l.user,l.tel1,l.name,l.updated_at]);break;case 6:Pt.push([l.lat,l.lon,l.cost,l.status,l.user,l.tel1,l.name,l.updated_at]);break;case 7:It.push([l.lat,l.lon,l.cost,l.status,l.user,l.tel1,l.name,l.updated_at]);break;case 8:Ot.push([l.lat,l.lon,l.cost,l.status,l.user,l.tel1,l.name,l.updated_at]);break;case 9:Gt.push([l.lat,l.lon,l.cost,l.status,l.user,l.tel1,l.name,l.updated_at]);break;default:At.push([l.lat,l.lon,l.cost,l.status,l.user,l.tel1,l.name,l.updated_at])}l.tel1&&l.tel1.toString(),p=v.circleMarker(v.latLng(l.lat,l.lon),Xt(h));const i=new Date(l.updated_at),t=`${i.getDate().toString().padStart(2,"0")}/${(i.getMonth()+1).toString().padStart(2,"0")}/${i.getFullYear()}`,e=`
      <strong>Precio:</strong> ${l.cost} Bs.<br>
      ${l.tel1?`<strong>Nombre:</strong> ${l.name}<br>`:""}
      ${l.tel1?`<strong>Telefono:</strong> ${l.tel1}<br>`:""}
      <em>${t}</em>
      `;p.bindPopup(e),l.status=="COT"?(l.user=="ADM"&&p.addTo(ct),l.user=="CLC"?p.addTo(ut):p.addTo(pt)):l.status=="EJE"?p.addTo(et[h]):p.addTo(et[10])}),{groupEje:et,groupCot:Wt}}var Qt={exports:{}};/*!
 Leaflet.MarkerCluster.LayerSupport 2.0.1+649b3a9
 (c) 2015-2018 Boris Seang
 License MIT
 */(function(u){(function(h,p){p(u.exports?v:h.L)})(dt,function(h,p){h.MarkerClusterGroup.LayerSupport=h.MarkerClusterGroup.extend({options:{singleAddRemoveBufferDuration:0},initialize:function(e){h.MarkerClusterGroup.prototype.initialize.call(this,e),this._featureGroup=new l,this._featureGroup.addEventParent(this),this._nonPointGroup=new l,this._nonPointGroup.addEventParent(this),this._layers={},this._proxyLayerGroups={},this._proxyLayerGroupsNeedRemoving={},this._singleAddRemoveBuffer=[]},checkIn:function(e){var o=this._toArray(e);return this._checkInGetSeparated(o),this},checkOut:function(e){var o,n,r=this._toArray(e),s=this._separateSingleFromGroupLayers(r,{groups:[],singles:[]}),a=s.groups,d=s.singles;for(o=0;o<d.length;o++)n=d[o],delete this._layers[h.stamp(n)],delete n._mcgLayerSupportGroup;for(this._originalRemoveLayers(d),o=0;o<a.length;o++)n=a[o],this._dismissProxyLayerGroup(n);return this},addLayers:function(e){var o,n,r,s=this._toArray(e),a=this._checkInGetSeparated(s),d=a.groups;for(this._originalAddLayers(a.singles),o=0;o<d.length;o++)n=d[o],r=h.stamp(n),this._proxyLayerGroups[r]=n,delete this._proxyLayerGroupsNeedRemoving[r],this._map&&this._map._originalAddLayer(n)},addLayer:function(e){return this._bufferSingleAddRemove(e,"addLayers"),this},_originalAddLayer:h.MarkerClusterGroup.prototype.addLayer,_originalAddLayers:h.MarkerClusterGroup.prototype.addLayers,removeLayers:function(e){var o,n,r=this._toArray(e),s=this._separateSingleFromGroupLayers(r,{groups:[],singles:[]}),a=s.groups,d=s.singles,c=0;for(this._originalRemoveLayers(d);c<a.length;c++)o=a[c],n=h.stamp(o),delete this._proxyLayerGroups[n],this._map?this._map._originalRemoveLayer(o):this._proxyLayerGroupsNeedRemoving[n]=o;return this},removeLayer:function(e){return this._bufferSingleAddRemove(e,"removeLayers"),this},_originalRemoveLayer:h.MarkerClusterGroup.prototype.removeLayer,_originalRemoveLayers:h.MarkerClusterGroup.prototype.removeLayers,onAdd:function(e){e._originalAddLayer=e._originalAddLayer||e.addLayer,e._originalRemoveLayer=e._originalRemoveLayer||e.removeLayer,h.extend(e,t);var o,n,r,s=this._removePreAddedLayers(e);this._originalOnAdd.call(this,e);for(o in this._proxyLayerGroups)n=this._proxyLayerGroups[o],e._originalAddLayer(n);for(o in this._proxyLayerGroupsNeedRemoving)n=this._proxyLayerGroupsNeedRemoving[o],e._originalRemoveLayer(n),delete this._proxyLayerGroupsNeedRemoving[o];for(r=0;r<s.length;r++)e.addLayer(s[r])},_originalOnAdd:h.MarkerClusterGroup.prototype.onAdd,_bufferSingleAddRemove:function(e,o){var n,r=this.options.singleAddRemoveBufferDuration;r>0?(this._singleAddRemoveBuffer.push({type:o,layer:e}),this._singleAddRemoveBufferTimeout||(n=h.bind(this._processSingleAddRemoveBuffer,this),this._singleAddRemoveBufferTimeout=setTimeout(n,r))):this[o](e)},_processSingleAddRemoveBuffer:function(){for(var e,o,n=this._singleAddRemoveBuffer,r=0,s=[];r<n.length;r++)e=n[r],o||(o=e.type),e.type===o?s.push(e.layer):(this[o](s),o=e.type,s=[e.layer]);this[o](s),n.length=0,clearTimeout(this._singleAddRemoveBufferTimeout),this._singleAddRemoveBufferTimeout=null},_checkInGetSeparated:function(e){var o,n,r=this._separateSingleFromGroupLayers(e,{groups:[],singles:[]}),s=r.groups,a=r.singles;for(o=0;o<s.length;o++)n=s[o],this._recruitLayerGroupAsProxy(n);for(o=0;o<a.length;o++)n=a[o],this._removeFromOtherGroupsOrMap(n),this._layers[h.stamp(n)]=n,n._mcgLayerSupportGroup=this;return r},_separateSingleFromGroupLayers:function(e,o){for(var n,r=o.groups,s=o.singles,a=h.Util.isArray,d=0;d<e.length;d++)n=e[d],n instanceof h.LayerGroup?(r.push(n),this._separateSingleFromGroupLayers(n.getLayers(),o)):a(n)?this._separateSingleFromGroupLayers(n,o):s.push(n);return o},_recruitLayerGroupAsProxy:function(e){var o=e._proxyMcgLayerSupportGroup;if(o){if(o===this)return;o.checkOut(e)}else this._removeFromOwnMap(e);e._proxyMcgLayerSupportGroup=this,e._originalAddLayer=e._originalAddLayer||e.addLayer,e._originalRemoveLayer=e._originalRemoveLayer||e.removeLayer,e._originalOnAdd=e._originalOnAdd||e.onAdd,e._originalOnRemove=e._originalOnRemove||e.onRemove,h.extend(e,i)},_dismissProxyLayerGroup:function(e){if(e._proxyMcgLayerSupportGroup!==p&&e._proxyMcgLayerSupportGroup===this){delete e._proxyMcgLayerSupportGroup,e.addLayer=e._originalAddLayer,e.removeLayer=e._originalRemoveLayer,e.onAdd=e._originalOnAdd,e.onRemove=e._originalOnRemove;var o=h.stamp(e);delete this._proxyLayerGroups[o],delete this._proxyLayerGroupsNeedRemoving[o],this._removeFromOwnMap(e)}},_removeFromOtherGroupsOrMap:function(e){var o=e._mcgLayerSupportGroup;if(o){if(o===this)return;o.checkOut(e)}else e.__parent?e.__parent._group.removeLayer(e):this._removeFromOwnMap(e)},_removeFromOwnMap:function(e){e._map&&e._map.removeLayer(e)},_removePreAddedLayers:function(e){var o,n=this._layers,r=[];for(var s in n)o=n[s],o._map&&(r.push(o),e._originalRemoveLayer(o));return r},_toArray:function(e){return h.Util.isArray(e)?e:[e]}});var l=h.FeatureGroup.extend({addLayer:function(e){if(this.hasLayer(e))return this;e.addEventParent(this);var o=h.stamp(e);return this._layers[o]=e,this._map&&this._map._originalAddLayer(e),this.fire("layeradd",{layer:e})},removeLayer:function(e){if(!this.hasLayer(e))return this;e in this._layers&&(e=this._layers[e]),e.removeEventParent(this);var o=h.stamp(e);return this._map&&this._layers[o]&&this._map._originalRemoveLayer(this._layers[o]),delete this._layers[o],this.fire("layerremove",{layer:e})},onAdd:function(e){this._map=e,this.eachLayer(e._originalAddLayer,e)},onRemove:function(e){this.eachLayer(e._originalRemoveLayer,e),this._map=null}}),i={addLayer:function(e){var o=this.getLayerId(e);return this._layers[o]=e,this._map?this._proxyMcgLayerSupportGroup.addLayer(e):this._proxyMcgLayerSupportGroup.checkIn(e),this},removeLayer:function(e){var o=e in this._layers?e:this.getLayerId(e);return this._proxyMcgLayerSupportGroup.removeLayer(e),delete this._layers[o],this},onAdd:function(){this._proxyMcgLayerSupportGroup.addLayers(this.getLayers())},onRemove:function(){this._proxyMcgLayerSupportGroup.removeLayers(this.getLayers())}},t={addLayer:function(e){return e._mcgLayerSupportGroup?e._mcgLayerSupportGroup._originalAddLayer(e):this._originalAddLayer(e)},removeLayer:function(e){return e._mcgLayerSupportGroup?e._mcgLayerSupportGroup._originalRemoveLayer(e):this._originalRemoveLayer(e)}};h.markerClusterGroup.layerSupport=function(e){return new h.MarkerClusterGroup.LayerSupport(e)}})})(Qt);let O;const Kt=["red","green","orange","cyan"],it=document.getElementById("overlay"),ot=["#B0B0B0","#FF5733","#286d31","#3357FF","#A633FF","#FF8333","#33FFD5","#D5FF33","#33A6FF","#5733FF","#787878","#FF33A6"],b=new v.Map("map",{tap:!1,center:[-17.784071,-63.180522],zoom:12,zoomControl:!1}),te=v.tileLayer("https://{s}.tile.osm.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(b),ee=v.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{maxZoom:19,attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"}),j=document.getElementById("putMarker");j.disabled=!0;const ie=await fetch("https://be.pozosscz.com/api/v1/areasfactor/").then(u=>u.json()).then(u=>u);let _t=[];ie.forEach((u,h)=>{const l=u.polygon.map(i=>new v.LatLng(i[0],i[1]));_t.push({label:`<span style="color: ${ot[h%ot.length]}">   ${u.name} ${u.factor}</span>`,layer:new v.Polygon(l,{color:ot[h]})})});let Z,P;({groupEje:P,groupCot:Z}=await Jt());var oe={spiderLegPolylineOptions:{weight:0},spiderfyOnMaxZoom:!0,zoomToBoundsOnClick:!1,removeOutsideVisibleBounds:!0,showCoverageOnHover:!0,disableClusteringAtZoom:18,maxClusterRadius:50,spiderfyDistanceMultiplier:1,chunkedLoading:!0,chunkInterval:100,singleAddRemoveBufferDuration:200},st=v.markerClusterGroup.layerSupport(oe);st.addTo(b);st.checkIn(Z);st.checkIn(P);var ne={label:"<strong>Capas Base</strong>",children:[{label:"OpenStreetMap",layer:te},{label:"Esri World Imagery",layer:ee}]},re={label:"<strong> Zonas / Clientes</strong>",selectAllCheckbox:"Un/select all",children:[{label:" Factor por zona",selectAllCheckbox:!0,children:_t},{label:" Ejecutados",selectAllCheckbox:"Un/select all",collapsed:!0,children:[{label:'<div class="puntos bg-precio300">&zwnj;</div>...300',layer:P[0]},{label:'<div class="puntos bg-precio350">&zwnj;</div>   350',layer:P[1]},{label:'<div class="puntos bg-precio400">&zwnj;</div>   400',layer:P[2]},{label:'<div class="puntos bg-precio450">&zwnj;</div>   450',layer:P[3]},{label:'<div class="puntos bg-precio500">&zwnj;</div>   500',layer:P[4]},{label:'<div class="puntos bg-precio600">&zwnj;</div>   600',layer:P[5]},{label:'<div class="puntos bg-precio700">&zwnj;</div>   700',layer:P[6]},{label:'<div class="puntos bg-precio800">&zwnj;</div>   800',layer:P[7]},{label:'<div class="puntos bg-precio900">&zwnj;</div>   900',layer:P[8]},{label:'<div class="puntos ml-0 bg-precio1000">&zwnj;</div> 1000...',layer:P[9]},{label:'<div class="puntos ml-0 bg-precioNegro">&zwnj;</div>  L.N',layer:P[10]}]},{label:" Cotizados",selectAllCheckbox:"Un/select all",collapsed:!0,children:[{label:"Administrador",layer:Z[0]},{label:"Cliente Confirma",layer:Z[1]},{label:"Cliente Cancela",layer:Z[2]}]}]};v.control.layers.tree(ne,re,{position:"bottomleft",collapsed:!1}).addTo(b);v.control.custom({position:"bottomcenter",content:`<div>
                    <button id="cotiza" class="btn btn-secondary sombra !text-white">
                    COTIZA
                    </button>
                  </div>`,classes:"pb-1",events:{click:de}}).addTo(b);var V=new v.FeatureGroup;b.addLayer(V);const se=new v.Control.Draw({edit:{featureGroup:V},draw:{polygon:{allowIntersection:!0,showArea:!0,drawError:{color:"#e1e100",message:"<strong>¡Oh no!</strong> no puedes dibujar eso!"},shapeOptions:{color:"#787878"}},polyline:!1,rectangle:!1,circle:!1,marker:!1,circlemarker:!1}});b.addControl(se);const ae=v.control.locate(vt);ae.addTo(b);function Y(u){O?b.removeLayer(O):Q.disabled=!1,O=new v.Marker(u.latlng,{icon:rt}).addTo(b),console.log("--Latitud, Longitud--"),console.log(u.latlng.lat.toFixed(7)+","+u.latlng.lng.toFixed(7))}b.on("click",Y);b.on(v.Draw.Event.DRAWSTART,function(){b.off("click",Y)});b.on(v.Draw.Event.CREATED,function(u){const h=u.layer;V.clearLayers(),V.addLayer(h),ft(h),b.on("click",Y)});b.on(v.Draw.Event.EDITED,function(u){u.layers.eachLayer(function(p){p instanceof v.Polygon&&ft(p)})});const Q=document.getElementById("cotiza");Q.disabled=!0;b.on("locationfound",function(u){const h=u.latlng.lat,p=u.latlng.lng;console.log("Latitud: "+h+", Longitud: "+p),O?b.removeLayer(O):(Q?.classList.remove("btn-disabled"),console.log("Marker no existe")),O=new v.Marker(u.latlng,{icon:rt}).addTo(b),b.flyTo(u.latlng,19)});b.on("locationerror",function(u){alert(u.message)});const R=document.getElementById("URLwhatsapp");R.addEventListener("input",u=>{R.value.length>=28?j.disabled=!1:j.disabled=!0});j.onclick=()=>{let u=0,h=0;try{if(R.value.indexOf("%2C")!=-1){let p=R.value.split("%2C"),l=p[0].split("?q="),i=p[1].split("&z=");u=parseFloat(l[1]),h=parseFloat(i[0])}if(R.value.indexOf(",")!=-1){let p=R.value.split(",");if(p.length==2){let l=p[0].split("?q=");l.length==1?u=parseFloat(p[0]):u=parseFloat(l[1]),h=parseFloat(p[1])}if(p.length==3){let l=p[0].split("/@");u=parseFloat(l[1]),h=parseFloat(p[1])}}b.flyTo([u,h],16),R.value="",O?b.removeLayer(O):Q.disabled=!1,O=new v.Marker([u,h],{icon:rt}),O.addTo(b),j.disabled=!0}catch{alert("Algo salió mal"),R.value=""}};function ft(u){if(u instanceof v.Polygon){const p=u.getLatLngs()[0].map(t=>[Number(t.lat.toFixed(6)),Number(t.lng.toFixed(6))]),l=JSON.stringify(p),i=document.getElementById("polygon-coordinates");i.value=l,I("polygon-coordinates","map","Las coordenadas del polígono han sido capturadas.","top","success")}else I("polygon-coordinates","map","El tipo de capa no es un polígono.","top","error")}const le=document.getElementById("submit-coordinates"),lt=document.getElementById("polygon-coordinates");le.addEventListener("click",()=>{if(!lt){I("coordenadas","map","El área de texto para las coordenadas no se encontró.","top","error");return}try{const u=JSON.parse(lt.value);if(Array.isArray(u)&&u.every(h=>Array.isArray(h)&&h.length===2)){const h=u.map(l=>new v.LatLng(l[0],l[1])),p=new v.Polygon(h,{color:"blue"});V.addLayer(p),b.fitBounds(p.getBounds())}else I("coordenadas","map","Formato de coordenadas inválido. Asegúrese de que las coordenadas estén en el formato correcto.","top","error")}catch{I("coordenadas","map","Error al parsear las coordenadas. Asegúrese de que las coordenadas estén en el formato JSON correcto.","top","error")}});const he=document.getElementById("savePolygon");he.addEventListener("submit",u=>{u.preventDefault();const h=u.target,p=document.getElementById("factor");let l=p.value.replace(",",".");if(console.log(l),isNaN(parseFloat(l)))return I("factor","map","Ingrese un valor numérico válido para el factor.","top","warning"),!1;p.value=l;const i=new FormData(h);return fetch(h.action,{method:h.method,body:i}).then(t=>{t.ok?(I("creaArea","map","Area agregada exitosamente","top","success"),setTimeout(()=>{location.reload()},3e3)):I("creaArea","map","Hubo un error al agregar el área","top","error")}).catch(t=>{I("creaArea","map","Hubo un error al agregar el área","top","error")}),!1});let nt,F,X,J;async function de(){let u,h,p,l,i,t,e,o;it.classList.remove("invisible");let n=await yt().then(C=>{let z=[];return C&&C.forEach(W=>{kt(O,W.polygon)&&z.push(W.factor)}),z});if(n.length===0)return it.classList.add("invisible"),alert("No se encontraron factores"),null;u=n.reduce((C,z)=>C*z,1),{paths:nt,distancias:F,tiempos:X,origenes:J}=await bt(O,1),nt.forEach(C=>C.addTo(b));const r=F.reduce((C,z,W,Lt)=>z<Lt[C]?W:C,0);h=await wt(),p=F[r]*h.p_km,l=X[r]*h.p_tiempo,i=h.p_base,t=i+(p<l?l:p),e=t*u,o=Math.round(e/10)*10;const s=document.getElementById("modalPrecio"),a=document.getElementById("modal-header");let d=!1,c=0,f=0;a.addEventListener("mousedown",C=>{d=!0,c=C.clientX-s.getBoundingClientRect().left,f=C.clientY-s.getBoundingClientRect().top,s.style.position="absolute",s.style.zIndex="1000"}),document.addEventListener("mousemove",C=>{d&&(s.style.left=`${C.clientX-c}px`,s.style.top=`${C.clientY-f}px`)}),document.addEventListener("mouseup",()=>{d=!1});const _=document.getElementById("xModal"),g=document.getElementById("tbValores"),m=document.getElementById("tbPrecios"),y=document.getElementById("tbMenor"),M=document.getElementById("tbFinal"),D=document.getElementById("formCost"),T=document.getElementById("formName"),S=document.getElementById("formPhone"),q=document.getElementById("p_base"),K=document.getElementById("p_km"),tt=document.getElementById("p_tiempo");ht(g,J,F,X);const $=F.map(C=>Math.round(C*h.p_km+i)),B=X.map(C=>Math.round(C*h.p_tiempo+i));ht(m,J,$,B);let A=document.createElement("tr"),U=document.createElement("td"),N=document.createElement("td"),k=document.createElement("td");U.innerHTML=J[r],N.innerHTML=Math.round(t).toString(),k.innerHTML=u.toString(),u!=1&&(k.style.color="red"),A.appendChild(U),A.appendChild(N),A.appendChild(k),y.appendChild(A);let w=document.createElement("tr"),E=document.createElement("td"),x=document.createElement("td"),G=document.createElement("td");E.innerHTML=Math.round(e).toString(),x.innerHTML=o.toString(),x.classList.add("text-lg","font-medium"),G.innerHTML=(Math.round(e*1.2/10)*10).toString(),w.appendChild(E),w.appendChild(x),w.appendChild(G),M.appendChild(w),s.classList.toggle("invisible"),it.classList.add("invisible"),b.off("click",Y);function H(){mt(),ce(),s.classList.toggle("invisible"),b.on("click",Y)}_.onclick=()=>{H()};function mt(){for(;g.firstChild;)g.removeChild(g.firstChild);for(;m.firstChild;)m.removeChild(m.firstChild);for(;y.firstChild;)y.removeChild(y.firstChild);for(;M.firstChild;)M.removeChild(M.firstChild);T.value="",S.value="",D.value=""}q.textContent=h.p_base.toString(),K.textContent=h.p_km.toString(),tt.textContent=h.p_tiempo.toString(),D.value=o.toString();const gt=document.getElementById("saveData");gt.onclick=async()=>{if(S.value.length<8){I("validación","map","El teléfono debe tener al menos 8 dígitos.","top","error");return}const C=parseInt(D.value,10);if(isNaN(C)||C<100){I("validación","map","El precio no debe quedar en blanco.","top","error");return}await Ct(T.value,S.value,C,O).then(()=>{I("postData","map","Datos guardados con éxito","top","success")}).catch(z=>{I("postData","map",`${z}`,"top","error")}),H()}}function ce(){nt.forEach(u=>{u.remove()})}function ht(u,h,p,l){h.forEach((i,t)=>{const e=document.createElement("tr"),o=document.createElement("td"),n=document.createElement("td"),r=document.createElement("td");o.textContent=i,o.style.color=Kt[t],n.textContent=p[t].toString(),r.textContent=l[t].toString(),e.appendChild(o),e.appendChild(n),e.appendChild(r),u.appendChild(e)})}
